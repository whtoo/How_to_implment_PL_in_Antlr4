# 设计文档一致性检查清单

## 概述
本文档提供 ep18r 寄存器虚拟机设计文档的一致性检查清单，确保所有文档在关键概念、术语和设计原则上保持一致。

## 检查项目

### 1. 术语一致性
- [ ] **寄存器架构**：所有文档统一使用"寄存器架构"而非"栈式架构"
- [ ] **指令集**：统一使用"寄存器指令集"描述 ep18r 的42条指令
- [ ] **虚拟机名称**：统一使用"ep18r寄存器虚拟机"或"Cymbol寄存器虚拟机"
- [ ] **寄存器命名**：r0-r15 统一使用小写"r"前缀

### 2. 设计原则一致性
- [ ] **独立性**：强调 ep18r 是独立的寄存器架构，不与栈式虚拟机绑定
- [ ] **优化目标**：强调寄存器架构的性能优势和优化方向
- [ ] **兼容性**：明确兼容性策略（如有），如转换工具而非语义等价

### 3. 文档引用一致性
- [ ] **交叉引用**：文档间的引用链接有效且准确
- [ ] **文件命名**：文档文件名与内容主题一致
- [ ] **版本信息**：重要文档包含版本或最后更新日期

### 4. 技术规格一致性
- [ ] **寄存器数量**：统一为16个通用寄存器 (r0-r15)
- [ ] **指令格式**：统一描述R/I/J三种32位指令格式
- [ ] **特殊寄存器**：统一r13(SP)、r14(FP)、r15(LR)的用途
- [ ] **内存模型**：统一描述堆、栈、常量池的内存布局

### 5. 实现状态一致性
- [ ] **当前状态**：文档反映当前实现进度（如寄存器指令集设计完成）
- [ ] **待实现功能**：明确标注未完成或计划中的功能
- [ ] **依赖关系**：明确模块间的依赖关系和技术栈

## 检查流程

### 定期检查
1. **月度检查**：每月检查一次所有设计文档
2. **重大更新后**：实现重大功能或架构变更后立即检查
3. **发布前**：每个版本发布前进行全面检查

### 检查步骤
1. 运行术语一致性检查（使用grep搜索关键术语）
2. 验证文档引用链接有效性
3. 核对技术规格与最新代码实现
4. 更新文档状态和版本信息

## 自动化检查脚本（建议）

```bash
#!/bin/bash
# 检查术语一致性
grep -r "语义等价" ep18r/docs/ && echo "发现遗留的语义等价引用"
grep -r "栈式虚拟机" ep18r/docs/ | grep -v "对比" && echo "检查栈式虚拟机引用上下文"

# 检查文档引用
find ep18r/docs -name "*.md" -exec grep -l "\.md" {} \; | while read f; do
    grep -o "\[.*\](.*\.md)" "$f" | while read link; do
        target=$(echo "$link" | sed -n 's/.*](\(.*\))/\1/p')
        if [ ! -f "ep18r/docs/$target" ]; then
            echo "无效链接: $f -> $target"
        fi
    done
done
```

## 维护责任
- **文档作者**：负责初始文档的一致性
- **技术负责人**：负责定期检查和协调更新
- **所有贡献者**：在修改文档时维护一致性

## 文档列表
需要保持一致性的核心文档：
1. `VM_Design.md` - 虚拟机整体设计
2. `寄存器指令集设计规范.md` - 指令集规范
3. `寄存器分配策略设计.md` - 寄存器分配策略
4. `虚拟机执行引擎设计.md` - 执行引擎设计
5. `汇编器_反汇编器设计.md` - 汇编工具设计
6. `VM设计文档索引.md` - 文档索引
7. `VM实现改进计划.md` - 实现计划
8. `ep18r-implementation-plan.md` - 详细实施计划

## 更新记录
- **2025-12-15**：创建初始清单，反映ep18r作为独立寄存器架构的定位
- **2025-12-15**：移除语义等价性要求，强调寄存器架构独立性