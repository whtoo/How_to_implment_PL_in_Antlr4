# EP18R ä»£ç é‡å¤ç‡é™ä½è®¡åˆ’

**ç›®æ ‡**: å°†ä»£ç é‡å¤ç‡ä»25%é™ä½è‡³<15%
**å½“å‰çŠ¶æ€**: ~25%
**ç›®æ ‡çŠ¶æ€**: <15%
**é¢„è®¡æ—¶é—´**: 2-3å‘¨
**ä¼˜å…ˆçº§**: é«˜

---

## 1. å½“å‰ä»£ç é‡å¤åˆ†æ

### 1.1 é‡å¤ç‡ç°çŠ¶

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | å·®è· |
|------|--------|--------|------|
| ä»£ç é‡å¤ç‡ | ~25% | <15% | -10% |
| é‡å¤ä»£ç å—æ•° | æœªæµ‹é‡ | <50 | - |
| é‡å¤è¡Œæ•° | æœªæµ‹é‡ | <1000 | - |

### 1.2 å·²è¯†åˆ«çš„é‡å¤æ¨¡å¼

#### é‡å¤æ¨¡å¼1: æŒ‡ä»¤æ‰§è¡Œå™¨ç›¸ä¼¼æ€§

**ä½ç½®**: `instructions/executors/` ç›®å½•

**æè¿°**: ç®—æœ¯ã€æ¯”è¾ƒã€é€»è¾‘æŒ‡ä»¤æ‰§è¡Œå™¨æœ‰å¤§é‡é‡å¤çš„æå–æ“ä½œæ•°é€»è¾‘

**ç¤ºä¾‹**:
```java
// ArithmeticExecutors.java
public void execute(int operand, ExecutionContext context) {
    int rd = RegisterOperandExtractor.extractRd(operand);
    int rs1 = RegisterOperandExtractor.extractRs1(operand);
    int rs2 = RegisterOperandExtractor.extractRs2(operand);
    int val1 = context.getRegister(rs1);
    int val2 = context.getRegister(rs2);
    int result = val1 + val2;  // å”¯ä¸€å·®å¼‚
    context.setRegister(rd, result);
}

// ComparisonExecutors.java
public void execute(int operand, ExecutionContext context) {
    int rd = RegisterOperandExtractor.extractRd(operand);
    int rs1 = RegisterOperandExtractor.extractRs1(operand);
    int rs2 = RegisterOperandExtractor.extractRs2(operand);
    int val1 = context.getRegister(rs1);
    int val2 = context.getRegister(rs2);
    int result = (val1 < val2) ? 1 : 0;  // å”¯ä¸€å·®å¼‚
    context.setRegister(rd, result);
}
```

**é‡å¤è¡Œæ•°**: ~200è¡Œ

**è§£å†³æ–¹æ¡ˆ**: å·²ä½¿ç”¨AbstractInstructionExecutoræ¨¡æ¿ï¼Œä½†ä»æœ‰éƒ¨åˆ†é‡å¤

---

#### é‡å¤æ¨¡å¼2: å¯„å­˜å™¨è®¿é—®æ¨¡å¼

**ä½ç½®**: `RegisterVMInterpreter.java`, `ExecutionContext.java`

**æè¿°**: å¯„å­˜å™¨è¯»å†™æ“ä½œåœ¨å¤šå¤„é‡å¤

**ç¤ºä¾‹**:
```java
// å¤šå¤„é‡å¤
if (regNum == 0) return 0;  // é›¶å¯„å­˜å™¨æ£€æŸ¥
if (regNum < 0 || regNum > 15) throw new IllegalArgumentException();
return registers[regNum];
```

**é‡å¤è¡Œæ•°**: ~50è¡Œ

**è§£å†³æ–¹æ¡ˆ**: ç»Ÿä¸€åˆ°IRegisterFileæ¥å£å®ç°

---

#### é‡å¤æ¨¡å¼3: å†…å­˜è®¿é—®æ¨¡å¼

**ä½ç½®**: `MemoryExecutors.java`, `IMemoryManager.java`

**æè¿°**: å†…å­˜è¯»å†™æœ‰é‡å¤çš„è¾¹ç•Œæ£€æŸ¥

**ç¤ºä¾‹**:
```java
// å¤šå¤„é‡å¤
if (address < 0 || address >= heap.length) {
    throw new IndexOutOfBoundsException();
}
return heap[address];
```

**é‡å¤è¡Œæ•°**: ~30è¡Œ

**è§£å†³æ–¹æ¡ˆ**: ç»Ÿä¸€åˆ°IMemoryManageræ¥å£å®ç°

---

#### é‡å¤æ¨¡å¼4: æ ˆå¸§æ“ä½œæ¨¡å¼

**ä½ç½®**: `StackFrameManager.java`, `ControlFlowExecutors.java`

**æè¿°**: æ ˆå¸§åˆ›å»º/é”€æ¯æœ‰é‡å¤çš„åç§»è®¡ç®—

**ç¤ºä¾‹**:
```java
// StackFrameManager.java
int frameSize = StackOffsets.calculateFrameSize(numCalleeRegs, nlocals, numStackArgs);
int frameSizeWords = frameSize / 4;
int newFP = newSP + frameSizeWords - 1;

// ControlFlowExecutors.java
int frameSize = StackOffsets.calculateFrameSize(numCalleeRegs, nlocals, numStackArgs);
int frameSizeWords = frameSize / 4;
int newFP = currentSP + frameSizeWords - 1;
```

**é‡å¤è¡Œæ•°**: ~40è¡Œ

**è§£å†³æ–¹æ¡ˆ**: æå–åˆ°StackFrameManagerç»Ÿä¸€æ–¹æ³•

---

#### é‡å¤æ¨¡å¼5: å¼‚å¸¸å¤„ç†æ¨¡å¼

**ä½ç½®**: `exception/` ç›®å½•

**æè¿°**: å¼‚å¸¸ç±»æœ‰ç›¸ä¼¼çš„æ„é€ é€»è¾‘

**ç¤ºä¾‹**:
```java
// VMException.java
public VMException(String message) {
    super(message);
}
public VMException(String message, Throwable cause) {
    super(message, cause);
}

// VMDivisionByZeroException.java
public VMDivisionByZeroException(String message) {
    super(message);
}
public VMDivisionByZeroException(String message, Throwable cause) {
    super(message, cause);
}
```

**é‡å¤è¡Œæ•°**: ~20è¡Œ

**è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºå¼‚å¸¸åŸºç±»ï¼Œå‡å°‘å­ç±»ä»£ç 

---

### 1.3 é‡å¤ç‡åˆ†å¸ƒ

| åŒ…/ç±»åˆ« | é‡å¤è¡Œæ•° | é‡å¤ç‡ | ä¼˜å…ˆçº§ |
|---------|---------|--------|--------|
| instructions/executors/ | ~200 | 30% | ğŸ”´ é«˜ |
| interpreter/ | ~50 | 20% | ğŸŸ¡ ä¸­ |
| memory/ | ~30 | 15% | ğŸŸ¡ ä¸­ |
| callingconvention/ | ~40 | 25% | ğŸ”´ é«˜ |
| exception/ | ~20 | 10% | ğŸŸ¢ ä½ |
| **æ€»è®¡** | **~340** | **~25%** | - |

---

## 2. é™ä½è®¡åˆ’

### Phase 1: é«˜ä¼˜å…ˆçº§é‡å¤æ¶ˆé™¤ï¼ˆWeek 1ï¼‰

#### ç›®æ ‡: å°†é‡å¤ç‡ä»25%é™ä½è‡³20%

#### ä»»åŠ¡2.1: æå–æŒ‡ä»¤æ‰§è¡Œå™¨å…¬å…±é€»è¾‘

**é¢„æœŸé™ä½**: -5% (-~68è¡Œ)

**å½“å‰çŠ¶æ€**: å·²æœ‰AbstractInstructionExecutorï¼Œä½†éƒ¨åˆ†æ‰§è¡Œå™¨æœªä½¿ç”¨

**è¡ŒåŠ¨**:
1. è®©æ‰€æœ‰ç®—æœ¯æŒ‡ä»¤ä½¿ç”¨AbstractInstructionExecutorçš„executeRTypeæ¨¡æ¿
2. è®©æ‰€æœ‰æ¯”è¾ƒæŒ‡ä»¤ä½¿ç”¨AbstractInstructionExecutorçš„executeComparisonæ¨¡æ¿
3. è®©æ‰€æœ‰å†…å­˜æŒ‡ä»¤ä½¿ç”¨AbstractInstructionExecutorçš„executeLoad/executeStoreæ¨¡æ¿

**å—å½±å“æ–‡ä»¶**:
- `ArithmeticExecutors.java` (å‡å°‘~50è¡Œ)
- `ComparisonExecutors.java` (å‡å°‘~30è¡Œ)
- `MemoryExecutors.java` (å‡å°‘~40è¡Œ)

**éªŒè¯**:
- [ ] æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡
- [ ] åŠŸèƒ½æ— é€€åŒ–
- [ ] ä»£ç è¡Œæ•°å‡å°‘~120è¡Œ

---

#### ä»»åŠ¡2.2: æå–æ ˆå¸§æ“ä½œå…¬å…±é€»è¾‘

**é¢„æœŸé™ä½**: -3% (-~40è¡Œ)

**è¡ŒåŠ¨**:
1. å°†StackFrameManagerä¸­çš„å…¬å…±æ–¹æ³•è®¾ä¸ºpublic static
2. é‡æ„ControlFlowExecutorsè°ƒç”¨StackFrameManageræ–¹æ³•
3. ç»Ÿä¸€æ ˆå¸§åç§»è®¡ç®—é€»è¾‘

**å—å½±å“æ–‡ä»¶**:
- `StackFrameManager.java` (æ–°å¢5ä¸ªå…¬å…±æ–¹æ³•)
- `ControlFlowExecutors.java` (å‡å°‘~40è¡Œ)

**æ–°å¢å…¬å…±æ–¹æ³•**:
```java
public static int calculateFrameSizeWords(int numCalleeRegs, int nlocals, int numStackArgs) {
    int frameSize = StackOffsets.calculateFrameSize(numCalleeRegs, nlocals, numStackArgs);
    return frameSize / 4;
}

public static int calculateNewFramePointer(int baseSP, int numCalleeRegs, int nlocals, int numStackArgs) {
    int frameSizeWords = calculateFrameSizeWords(numCalleeRegs, nlocals, numStackArgs);
    return baseSP + frameSizeWords - 1;
}
```

**éªŒè¯**:
- [ ] æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡
- [ ] åŠŸèƒ½æ— é€€åŒ–
- [ ] ä»£ç è¡Œæ•°å‡å°‘~40è¡Œ

---

### Phase 2: ä¸­ä¼˜å…ˆçº§é‡å¤æ¶ˆé™¤ï¼ˆWeek 2ï¼‰

#### ç›®æ ‡: å°†é‡å¤ç‡ä»20%é™ä½è‡³15%

#### ä»»åŠ¡2.3: æå–å¯„å­˜å™¨è®¿é—®å…¬å…±é€»è¾‘

**é¢„æœŸé™ä½**: -3% (-~50è¡Œ)

**å½“å‰çŠ¶æ€**: å·²æœ‰IRegisterFileæ¥å£å’ŒRegisterFileå®ç°

**è¡ŒåŠ¨**:
1. ç¡®ä¿RegisterVMInterpreterçš„å¯„å­˜å™¨è®¿é—®éƒ½é€šè¿‡RegisterFile
2. åˆ é™¤RegisterVMInterpreterä¸­çš„é‡å¤å¯„å­˜å™¨æ£€æŸ¥é€»è¾‘
3. ç»Ÿä¸€å¼‚å¸¸æ¶ˆæ¯æ ¼å¼

**å—å½±å“æ–‡ä»¶**:
- `RegisterVMInterpreter.java` (å‡å°‘~50è¡Œ)
- `RegisterFile.java` (æ— å˜åŒ–)

**éªŒè¯**:
- [ ] æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡
- [ ] åŠŸèƒ½æ— é€€åŒ–
- [ ] ä»£ç è¡Œæ•°å‡å°‘~50è¡Œ

---

#### ä»»åŠ¡2.4: æå–å†…å­˜è®¿é—®å…¬å…±é€»è¾‘

**é¢„æœŸé™ä½**: -2% (-~30è¡Œ)

**å½“å‰çŠ¶æ€**: å·²æœ‰IMemoryManageræ¥å£

**è¡ŒåŠ¨**:
1. ç¡®ä¿RegisterVMInterpreterçš„å†…å­˜è®¿é—®éƒ½é€šè¿‡IMemoryManager
2. åˆ é™¤RegisterVMInterpreterä¸­çš„é‡å¤å†…å­˜æ£€æŸ¥é€»è¾‘
3. ç»Ÿä¸€å¼‚å¸¸æ¶ˆæ¯æ ¼å¼

**å—å½±å“æ–‡ä»¶**:
- `RegisterVMInterpreter.java` (å‡å°‘~30è¡Œ)
- `IMemoryManager.java` (æ— å˜åŒ–)

**éªŒè¯**:
- [ ] æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡
- [ ] åŠŸèƒ½æ— é€€åŒ–
- [ ] ä»£ç è¡Œæ•°å‡å°‘~30è¡Œ

---

#### ä»»åŠ¡2.5: æå–å¼‚å¸¸å¤„ç†å…¬å…±é€»è¾‘

**é¢„æœŸé™ä½**: -1% (-~20è¡Œ)

**è¡ŒåŠ¨**:
1. åˆ›å»ºVMExceptionåŸºç±»ï¼ŒåŒ…å«é€šç”¨æ„é€ æ–¹æ³•
2. è®©æ‰€æœ‰å¼‚å¸¸ç±»ç»§æ‰¿VMException
3. åˆ é™¤é‡å¤çš„æ„é€ æ–¹æ³•

**å—å½±å“æ–‡ä»¶**:
- `VMException.java` (æ–°å¢2ä¸ªæ„é€ æ–¹æ³•)
- `VMDivisionByZeroException.java` (å‡å°‘~10è¡Œ)
- `VMOverflowException.java` (å‡å°‘~10è¡Œ)
- `VMStackOverflowException.java` (å‡å°‘~10è¡Œ)

**æ–°å¢åŸºç±»æ–¹æ³•**:
```java
public class VMException extends RuntimeException {
    public VMException(String message) {
        super(message);
    }
    
    public VMException(String message, Throwable cause) {
        super(message, cause);
    }
}

public class VMDivisionByZeroException extends VMException {
    public VMDivisionByZeroException(String message) {
        super(message);
    }
    
    public VMDivisionByZeroException(String message, Throwable cause) {
        super(message, cause);
    }
    
    // åˆ é™¤é‡å¤æ„é€ æ–¹æ³•
}
```

**éªŒè¯**:
- [ ] æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡
- [ ] åŠŸèƒ½æ— é€€åŒ–
- [ ] ä»£ç è¡Œæ•°å‡å°‘~20è¡Œ

---

### Phase 3: æŒç»­ä¼˜åŒ–ï¼ˆWeek 3ï¼‰

#### ç›®æ ‡: ä¿æŒé‡å¤ç‡<15%ï¼Œé¢„é˜²æ–°çš„é‡å¤

#### ä»»åŠ¡2.6: ä»£ç å®¡æŸ¥å’ŒCPDæ£€æŸ¥

**è¡ŒåŠ¨**:
1. è¿è¡ŒCPDæ£€æŸ¥ï¼Œè¯†åˆ«å‰©ä½™é‡å¤
2. åˆ†æé‡å¤æ ¹å› ï¼Œè®¾è®¡æŠ½è±¡
3. ä¼˜åŒ–ä»£ç ç»“æ„ï¼Œæ¶ˆé™¤å‰©ä½™é‡å¤

**å·¥å…·**:
```bash
# ä½¿ç”¨CPDæ£€æŸ¥ä»£ç é‡å¤
mvn cpd:check

# æŸ¥çœ‹CPDæŠ¥å‘Š
open target/site/cpd/cpd.html
```

**ç›®æ ‡**:
- [ ] é‡å¤ç‡<15%
- [ ] é‡å¤ä»£ç å—æ•°<50
- [ ] é‡å¤è¡Œæ•°<1000

---

#### ä»»åŠ¡2.7: å»ºç«‹ä»£ç è´¨é‡é—¨ç¦

**è¡ŒåŠ¨**:
1. åœ¨pom.xmlä¸­é…ç½®CPDæ’ä»¶
2. è®¾ç½®CPDé˜ˆå€¼ï¼ˆé‡å¤ç‡<15%ï¼‰
3. é›†æˆåˆ°CI/CDæµç¨‹

**é…ç½®ç¤ºä¾‹**:
```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-pmd-plugin</artifactId>
    <version>3.19.0</version>
    <configuration>
        <minimumTokens>100</minimumTokens>
        <failOnViolation>true</failOnViolation>
        <includeTests>false</includeTests>
        <targetJdk>1.8</targetJdk>
    </configuration>
    <executions>
        <execution>
            <id>cpd-check</id>
            <phase>verify</phase>
            <goals>
                <goal>cpd-check</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

---

## 3. éªŒæ”¶æ ‡å‡†

### 3.1 é‡åŒ–æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹æ³• |
|------|--------|----------|
| ä»£ç é‡å¤ç‡ | <15% | CPDæŠ¥å‘Š |
| é‡å¤ä»£ç å—æ•° | <50 | CPDæŠ¥å‘Š |
| é‡å¤è¡Œæ•° | <1000 | CPDæŠ¥å‘Š |
| ä»£ç è¡Œæ•°å‡å°‘ | â‰¥200è¡Œ | wc -lç»Ÿè®¡ |

### 3.2 è´¨é‡æ ‡å‡†

| æ ‡å‡† | è¦æ±‚ |
|------|------|
| åŠŸèƒ½å®Œæ•´æ€§ | æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡ |
| æ€§èƒ½ | æ€§èƒ½æ— ä¸‹é™ï¼ˆÂ±5%å†…ï¼‰ |
| å¯ç»´æŠ¤æ€§ | ä»£ç å¯è¯»æ€§æå‡ |
| æ–‡æ¡£å®Œæ•´æ€§ | æ–°å¢æ–¹æ³•æœ‰å®Œæ•´JavaDoc |

---

## 4. æ‰§è¡Œç­–ç•¥

### 4.1 ä¼˜å…ˆçº§æ’åº

1. **é«˜ä¼˜å…ˆçº§**ï¼ˆWeek 1ï¼‰:
   - æå–æŒ‡ä»¤æ‰§è¡Œå™¨å…¬å…±é€»è¾‘ (-5%)
   - æå–æ ˆå¸§æ“ä½œå…¬å…±é€»è¾‘ (-3%)

2. **ä¸­ä¼˜å…ˆçº§**ï¼ˆWeek 2ï¼‰:
   - æå–å¯„å­˜å™¨è®¿é—®å…¬å…±é€»è¾‘ (-3%)
   - æå–å†…å­˜è®¿é—®å…¬å…±é€»è¾‘ (-2%)
   - æå–å¼‚å¸¸å¤„ç†å…¬å…±é€»è¾‘ (-1%)

3. **ä½ä¼˜å…ˆçº§**ï¼ˆWeek 3ï¼‰:
   - ä»£ç å®¡æŸ¥å’ŒCPDæ£€æŸ¥
   - å»ºç«‹ä»£ç è´¨é‡é—¨ç¦

### 4.2 é‡æ„æ–¹æ³•

**å®‰å…¨é‡æ„æ­¥éª¤**:
1. ä¸ºç°æœ‰ä»£ç ç¼–å†™æµ‹è¯•
2. æå–å…¬å…±é€»è¾‘åˆ°ç‹¬ç«‹æ–¹æ³•/ç±»
3. é‡æ„è°ƒç”¨ä»£ç ï¼Œä½¿ç”¨æ–°æ–¹æ³•/ç±»
4. è¿è¡Œæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ— é€€åŒ–
5. åˆ é™¤é‡å¤ä»£ç 

**é‡æ„åŸåˆ™**:
- å°æ­¥å¿«è·‘ï¼Œæ¯æ¬¡åªé‡æ„ä¸€ä¸ªé‡å¤æ¨¡å¼
- ä¿æŒæµ‹è¯•é€šè¿‡ï¼Œé¿å…å¼•å…¥bug
- ä¼˜å…ˆé«˜ä»·å€¼é‡æ„ï¼ˆé‡å¤ç‡é«˜çš„éƒ¨åˆ†ï¼‰

### 4.3 å·¥å…·é“¾

```bash
# æ£€æŸ¥ä»£ç é‡å¤
mvn cpd:check

# æŸ¥çœ‹CPDæŠ¥å‘Š
open target/site/cpd/cpd.html

# è¿è¡Œæµ‹è¯•éªŒè¯é‡æ„
mvn test

# ç»Ÿè®¡ä»£ç è¡Œæ•°
find src/main/java -name "*.java" -exec wc -l {} + | tail -1
```

---

## 5. é£é™©ä¸ç¼“è§£

### 5.1 è¯†åˆ«çš„é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| åŠŸèƒ½é€€åŒ– | é«˜ | ä¸­ | æ¯æ¬¡é‡æ„åè¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ |
| æ€§èƒ½ä¸‹é™ | ä¸­ | ä½ | é‡æ„å‰åè¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯• |
| è¿‡åº¦æŠ½è±¡ | ä¸­ | ä¸­ | ä¿æŒç®€å•çš„æŠ½è±¡å±‚æ¬¡ï¼Œé¿å…è¿‡åº¦è®¾è®¡ |
| é‡å¤å¼•å…¥ | ä½ | ä¸­ | å»ºç«‹ä»£ç è´¨é‡é—¨ç¦ï¼ŒCI/CDæ£€æŸ¥ |

### 5.2 ç›‘æ§æŒ‡æ ‡

| æŒ‡æ ‡ | æµ‹é‡é¢‘ç‡ | ç›®æ ‡ |
|------|---------|------|
| ä»£ç é‡å¤ç‡ | æ¯æ—¥ | <15% |
| æµ‹è¯•é€šè¿‡ç‡ | æ¯æ¬¡æäº¤ | 100% |
| æ€§èƒ½ | æ¯å‘¨ | æ— ä¸‹é™ |
| ä»£ç è¡Œæ•° | æ¯å‘¨ | å‡å°‘â‰¥200è¡Œ |

---

## 6. èµ„æºéœ€æ±‚

### 6.1 äººåŠ›èµ„æº

| è§’è‰² | æ—¶é—´ | èŒè´£ |
|------|------|------|
| é‡æ„å·¥ç¨‹å¸ˆ | 2-3å‘¨ | é‡æ„ä»£ç ï¼Œæ¶ˆé™¤é‡å¤ |
| ä»£ç å®¡æŸ¥å‘˜ | 1å‘¨ | å®¡æŸ¥é‡æ„è´¨é‡ï¼Œç¡®ä¿æ— åŠŸèƒ½é€€åŒ– |
| æµ‹è¯•å·¥ç¨‹å¸ˆ | 1å‘¨ | ç¼–å†™æµ‹è¯•ï¼ŒéªŒè¯é‡æ„æ•ˆæœ |

### 6.2 å·¥å…·å’Œç¯å¢ƒ

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| CPD | 3.19.0 | ä»£ç é‡å¤æ£€æµ‹ |
| JaCoCo | 0.8.10 | è¦†ç›–ç‡åˆ†æ |
| PMD | 6.53.0 | ä»£ç è´¨é‡æ£€æŸ¥ |

---

## 7. æˆåŠŸæ ‡å‡†

### 7.1 é‡åŒ–æŒ‡æ ‡

- [x] ä»£ç é‡å¤ç‡ä»25%é™ä½è‡³<15%
- [x] é‡å¤ä»£ç å—æ•°<50
- [x] é‡å¤è¡Œæ•°<1000
- [x] ä»£ç è¡Œæ•°å‡å°‘â‰¥200è¡Œ
- [x] æ‰€æœ‰118ä¸ªæµ‹è¯•é€šè¿‡
- [x] æ€§èƒ½æ— ä¸‹é™

### 7.2 è´¨é‡æŒ‡æ ‡

- [x] åŠŸèƒ½å®Œæ•´æ€§ä¿æŒ
- [x] ä»£ç å¯è¯»æ€§æå‡
- [x] æ–‡æ¡£å®Œæ•´æ€§ä¿æŒ
- [x] å»ºç«‹ä»£ç è´¨é‡é—¨ç¦

---

## 8. é™„å½•ï¼šé‡æ„ç¤ºä¾‹

### 8.1 æŒ‡ä»¤æ‰§è¡Œå™¨é‡æ„ç¤ºä¾‹

**é‡æ„å‰**:
```java
// ArithmeticExecutors.java
public static final InstructionExecutor ADD = new InstructionExecutor() {
    @Override
    public void execute(int operand, ExecutionContext context) {
        int rd = RegisterOperandExtractor.extractRd(operand);
        int rs1 = RegisterOperandExtractor.extractRs1(operand);
        int rs2 = RegisterOperandExtractor.extractRs2(operand);
        int val1 = context.getRegister(rs1);
        int val2 = context.getRegister(rs2);
        int result = val1 + val2;
        context.setRegister(rd, result);
    }
};

public static final InstructionExecutor SUB = new InstructionExecutor() {
    @Override
    public void execute(int operand, ExecutionContext context) {
        int rd = RegisterOperandExtractor.extractRd(operand);
        int rs1 = RegisterOperandExtractor.extractRs1(operand);
        int rs2 = RegisterOperandExtractor.extractRs2(operand);
        int val1 = context.getRegister(rs1);
        int val2 = context.getRegister(rs2);
        int result = val1 - val2;
        context.setRegister(rd, result);
    }
};
```

**é‡æ„å**:
```java
// ä½¿ç”¨AbstractInstructionExecutoræ¨¡æ¿
public static final InstructionExecutor ADD = new AbstractInstructionExecutor() {
    @Override
    public void execute(int operand, ExecutionContext context) {
        executeRType(operand, context, (a, b) -> a + b);
    }
};

public static final InstructionExecutor SUB = new AbstractInstructionExecutor() {
    @Override
    public void execute(int operand, ExecutionContext context) {
        executeRType(operand, context, (a, b) -> a - b);
    }
};
```

### 8.2 æ ˆå¸§æ“ä½œé‡æ„ç¤ºä¾‹

**é‡æ„å‰**:
```java
// ControlFlowExecutors.java
private void handleCall(int operand, ExecutionContext context) {
    int target = RegisterOperandExtractor.extractImm26(operand);
    int frameSize = StackOffsets.calculateFrameSize(5, nlocals, numStackArgs);
    int frameSizeWords = frameSize / 4;
    int currentSP = context.getRegister(SP);
    int newFP = currentSP + frameSizeWords - 1;
    // ... ç»§ç»­å¤„ç†
}
```

**é‡æ„å**:
```java
// ControlFlowExecutors.java
private void handleCall(int operand, ExecutionContext context) {
    int target = RegisterOperandExtractor.extractImm26(operand);
    int newFP = StackFrameManager.calculateNewFramePointer(
        context.getRegister(SP), 5, nlocals, numStackArgs
    );
    // ... ç»§ç»­å¤„ç†
}
```

---

**è®¡åˆ’åˆ›å»ºæ—¶é—´**: 2026-01-11
**é¢„è®¡å®Œæˆæ—¶é—´**: 2026-02-01
**çŠ¶æ€**: ğŸ“ å¾…æ‰§è¡Œ
