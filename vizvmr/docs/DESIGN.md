# EP18R å¯è§†åŒ–æ¨¡å— (vizvmr) è®¾è®¡æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

**vizvmr** æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¯è§†åŒ–æ¨¡å—ï¼Œä¸º EP18R å¯„å­˜å™¨è™šæ‹Ÿæœºæä¾›å®æ—¶çš„å›¾å½¢åŒ–æ‰§è¡Œè¿‡ç¨‹å±•ç¤ºã€‚è¯¥æ¨¡å—é‡‡ç”¨è§‚å¯Ÿè€…æ¨¡å¼è®¾è®¡ï¼Œé€šè¿‡äº‹ä»¶ç›‘å¬å™¨æ•è·è™šæ‹Ÿæœºæ‰§è¡ŒçŠ¶æ€ï¼Œä½¿ç”¨ Java Swing æ„å»ºäº¤äº’å¼ GUI ç•Œé¢ã€‚

## ğŸ¯ è®¾è®¡ç›®æ ‡

1. **å®æ—¶å¯è§†åŒ–**: æ˜¾ç¤ºå¯„å­˜å™¨æ–‡ä»¶ã€å†…å­˜ã€è°ƒç”¨æ ˆç­‰è™šæ‹Ÿæœºç»„ä»¶çš„å®æ—¶çŠ¶æ€
2. **äº¤äº’å¼æ§åˆ¶**: æä¾›å•æ­¥æ‰§è¡Œã€æ–­ç‚¹è®¾ç½®ã€æš‚åœ/ç»§ç»­ç­‰è°ƒè¯•åŠŸèƒ½
3. **çŠ¶æ€è·Ÿè¸ª**: è®°å½•å’Œå›æ”¾æŒ‡ä»¤æ‰§è¡Œå†å²
4. **æ•™å­¦å‹å¥½**: ç•Œé¢ç›´è§‚ï¼Œé€‚åˆç¼–è¯‘å™¨åŸç†æ•™å­¦æ¼”ç¤º
5. **æ¨¡å—åŒ–è®¾è®¡**: ç‹¬ç«‹æ¨¡å—ï¼Œä¸ EP18R è™šæ‹Ÿæœºæ¾è€¦åˆ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    vizvmr å¯è§†åŒ–æ¨¡å—                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ GUIå±‚   â”‚  â”‚æ§åˆ¶å±‚   â”‚  â”‚æ¨¡å‹å±‚   â”‚  â”‚é›†æˆå±‚   â”‚   â”‚
â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚  â”‚         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚              â”‚              â”‚
         â–¼              â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                EP18R å¯„å­˜å™¨è™šæ‹Ÿæœºæ¨¡å—                    â”‚
â”‚                 (RegisterVMInterpreter)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„å±‚æ¬¡
1. **GUIå±‚ (Presentation Layer)**: Java Swing ç»„ä»¶ï¼Œè´Ÿè´£ç•Œé¢æ¸²æŸ“å’Œç”¨æˆ·äº¤äº’
2. **æ§åˆ¶å±‚ (Control Layer)**: æ‰§è¡Œæ§åˆ¶å™¨ã€æ–­ç‚¹ç®¡ç†å™¨ã€å†å²è®°å½•ç®¡ç†å™¨
3. **æ¨¡å‹å±‚ (Model Layer)**: çŠ¶æ€æ¨¡å‹ã€äº‹ä»¶ç³»ç»Ÿã€æ•°æ®ç®¡ç†å±‚
4. **é›†æˆå±‚ (Integration Layer)**: è™šæ‹Ÿæœºæ’æ¡©é€‚é…å™¨ã€æ¡¥æ¥å™¨ã€æ¥å£é€‚é…å™¨

## ğŸ“ æ¨¡å—ç»“æ„

### åŒ…ç»“æ„
```
org.teachfx.antlr4.ep18r.vizvmr/
â”œâ”€â”€ VizVMRLauncher.java            # ç‹¬ç«‹å¯åŠ¨å™¨
â”‚
â”œâ”€â”€ core/                          # æ ¸å¿ƒæ¨¡å‹
â”‚   â”œâ”€â”€ VMRStateModel.java         # çŠ¶æ€æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ VMRExecutionHistory.java   # æ‰§è¡Œå†å²è®°å½•
â”‚
â”œâ”€â”€ event/                         # äº‹ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ VMRStateListener.java      # çŠ¶æ€ç›‘å¬å™¨æ¥å£ (å«vmStateChanged)
â”‚   â”œâ”€â”€ VMRExecutionListener.java  # æ‰§è¡Œç›‘å¬å™¨æ¥å£
â”‚   â”œâ”€â”€ VMRStateEvent.java         # çŠ¶æ€äº‹ä»¶åŸºç±»
â”‚   â”œâ”€â”€ RegisterChangeEvent.java   # å¯„å­˜å™¨å˜åŒ–äº‹ä»¶
â”‚   â”œâ”€â”€ MemoryChangeEvent.java     # å†…å­˜å˜åŒ–äº‹ä»¶
â”‚   â”œâ”€â”€ PCChangeEvent.java         # ç¨‹åºè®¡æ•°å™¨å˜åŒ–äº‹ä»¶
â”‚   â”œâ”€â”€ InstructionExecutionEvent.java # æŒ‡ä»¤æ‰§è¡Œäº‹ä»¶
â”‚   â””â”€â”€ VMStateChangeEvent.java    # è™šæ‹ŸæœºçŠ¶æ€å˜åŒ–äº‹ä»¶
â”‚
â”œâ”€â”€ integration/                   # é›†æˆå±‚
â”‚   â”œâ”€â”€ VMRInstrumentation.java    # è™šæ‹Ÿæœºæ’æ¡©é€‚é…å™¨
â”‚   â””â”€â”€ VMRVisualBridge.java       # å¯è§†åŒ–æ¡¥æ¥å™¨
â”‚
â”œâ”€â”€ controller/                    # æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ VMRStepController.java     # å•æ­¥æ‰§è¡Œæ§åˆ¶å™¨
â”‚   â””â”€â”€ VMRBreakpointManager.java  # æ–­ç‚¹ç®¡ç†å™¨
â”‚
â”œâ”€â”€ ui/                            # ç”¨æˆ·ç•Œé¢
â”‚   â”œâ”€â”€ MainFrame.java             # ä¸»çª—å£æ¡†æ¶
â”‚   â”œâ”€â”€ panel/                     # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ RegisterPanel.java     # å¯„å­˜å™¨æ˜¾ç¤ºé¢æ¿
â”‚   â”‚   â”œâ”€â”€ MemoryPanel.java       # å†…å­˜æ˜¾ç¤ºé¢æ¿
â”‚   â”‚   â”œâ”€â”€ CodePanel.java         # ä»£ç æ˜¾ç¤ºé¢æ¿
â”‚   â”‚   â”œâ”€â”€ StackPanel.java        # è°ƒç”¨æ ˆé¢æ¿
â”‚   â”‚   â”œâ”€â”€ ControlPanel.java      # æ§åˆ¶é¢æ¿
â”‚   â”‚   â”œâ”€â”€ StatusPanel.java       # çŠ¶æ€é¢æ¿
â”‚   â”‚   â””â”€â”€ LogPanel.java          # æ—¥å¿—é¢æ¿ (æ–°å¢)
â”‚   â””â”€â”€ dialog/                    # å¯¹è¯æ¡† (é¢„ç•™)
â”‚
â””â”€â”€ util/                          # å·¥å…·ç±»
    â””â”€â”€ ConfigPersistence.java     # é…ç½®æŒä¹…åŒ– (æ–°å¢)
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. äº‹ä»¶ç›‘å¬å™¨ç³»ç»Ÿ (Event Listener System)

#### çŠ¶æ€ç›‘å¬å™¨ (VMRStateListener)
```java
public interface VMRStateListener extends EventListener {
    void registerChanged(RegisterChangeEvent event);
    void memoryChanged(MemoryChangeEvent event);
    void pcChanged(PCChangeEvent event);
    void vmStateChanged(VMStateChangeEvent event);  // æ·»åŠ ï¼šè™šæ‹ŸæœºçŠ¶æ€å˜åŒ–ç›‘å¬
    default void registersUpdated(RegisterChangeEvent[] events);
    default void memoryUpdated(MemoryChangeEvent[] events);
}
```

#### æ‰§è¡Œç›‘å¬å™¨ (VMRExecutionListener)
```java
public interface VMRExecutionListener extends EventListener {
    default void instructionFetched(InstructionExecutionEvent event);
    default void beforeInstructionDecode(InstructionExecutionEvent event);
    default void beforeInstructionExecute(InstructionExecutionEvent event);
    default void afterInstructionExecute(InstructionExecutionEvent event);
    void vmStateChanged(VMStateChangeEvent event);
    default void executionError(Throwable error, int pc);
    default void executionStarted();
    default void executionFinished();
    default void executionPaused();
}
```

### 2. çŠ¶æ€æ¨¡å‹ (VMRStateModel)

#### èŒè´£
- ç®¡ç†è™šæ‹Ÿæœºæ‰€æœ‰çŠ¶æ€ï¼ˆå¯„å­˜å™¨ã€å†…å­˜ã€è°ƒç”¨æ ˆã€PCç­‰ï¼‰
- æä¾›çŠ¶æ€å˜æ›´é€šçŸ¥æœºåˆ¶
- ç»´æŠ¤ä¿®æ”¹è¿½è¸ªå’Œæ€§èƒ½ç»Ÿè®¡
- æ”¯æŒæ‰¹å¤„ç†æ›´æ–°ä»¥æé«˜æ€§èƒ½

#### å…³é”®æ•°æ®ç»“æ„
```java
public class VMRStateModel {
    // çŠ¶æ€å­˜å‚¨
    private final int[] registers;                 // 16ä¸ªå¯„å­˜å™¨å€¼
    private int[] heap;                            // å †å†…å­˜ (éfinalï¼Œæ”¯æŒrestoreSnapshot)
    private int[] globals;                         // å…¨å±€å˜é‡ (éfinalï¼Œæ”¯æŒrestoreSnapshot)
    private final StackFrame[] callStack;          // è°ƒç”¨æ ˆ
    private int framePointer;                      // å½“å‰å¸§æŒ‡é’ˆ
    private int programCounter;                    // ç¨‹åºè®¡æ•°å™¨
    private int heapAllocPointer;                  // å †åˆ†é…æŒ‡é’ˆ

    // ä¿®æ”¹è¿½è¸ª
    private final boolean[] registerModified;      // å¯„å­˜å™¨ä¿®æ”¹æ ‡è®°
    private final Set<Integer> modifiedMemoryAddresses; // å†…å­˜ä¿®æ”¹åœ°å€
    private final Set<Integer> modifiedHeapAddresses;   // å †ä¿®æ”¹åœ°å€

    // ç›‘å¬å™¨ç®¡ç†
    private final List<VMRStateListener> stateListeners;
    private final List<VMRExecutionListener> executionListeners;

    // æ‰§è¡ŒçŠ¶æ€
    private volatile VMStateChangeEvent.State vmState;
    private long executionSteps;
    private long startTime;
    private int eventStepNumber;                   // äº‹ä»¶æ­¥æ•°è®¡æ•°å™¨
}
```

### 3. è™šæ‹Ÿæœºæ’æ¡©é€‚é…å™¨ (VMRInstrumentation)

#### è®¾è®¡æ¨¡å¼ï¼šé€‚é…å™¨æ¨¡å¼ + åå°„
- **ç›®çš„**: åœ¨ä¸ä¿®æ”¹ EP18R æºä»£ç çš„æƒ…å†µä¸‹ç›‘å¬è™šæ‹Ÿæœºå†…éƒ¨çŠ¶æ€
- **å®ç°**: ä½¿ç”¨ Java åå°„è®¿é—®è™šæ‹Ÿæœºç§æœ‰å­—æ®µå’Œæ–¹æ³•
- **å…³é”®æ’æ¡©ç‚¹**:
  - å¯„å­˜å™¨è¯»å†™æ“ä½œ
  - å†…å­˜è®¿é—®æ“ä½œ
  - ç¨‹åºè®¡æ•°å™¨æ›´æ–°
  - è°ƒç”¨æ ˆæ“ä½œ
  - æŒ‡ä»¤æ‰§è¡Œå‰å

#### åå°„å­—æ®µè®¿é—®
```java
public class VMRInstrumentation {
    // åå°„å­—æ®µç¼“å­˜
    private Field registersField;
    private Field programCounterField;
    private Field framePointerField;
    private Field heapField;
    private Field heapAllocPointerField;
    private Field callStackField;
    private Field runningField;
    
    // åŒæ­¥çŠ¶æ€åˆ°æ¨¡å‹
    public void syncState() {
        syncRegisters();
        syncMemory();
        syncCallStack();
        syncProgramCounter();
    }
}
```

### 4. å¯è§†åŒ–æ¡¥æ¥å™¨ (VMRVisualBridge)

#### èŒè´£
- è¿æ¥è™šæ‹Ÿæœºå’Œå¯è§†åŒ–ç•Œé¢
- ç®¡ç†æ‰§è¡Œçº¿ç¨‹å’Œæ§åˆ¶æµ
- æä¾›åæ±‡ç¼–æ”¯æŒ
- å¤„ç†æ‰§è¡Œæ§åˆ¶ï¼ˆå¯åŠ¨ã€æš‚åœã€åœæ­¢ã€å•æ­¥ï¼‰

#### æ‰§è¡Œæ§åˆ¶çŠ¶æ€æœº
```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ç©ºé—²    â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚ loadProgram()
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  å·²åŠ è½½  â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚ startExecution()
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ æ‰§è¡Œä¸­   â”‚â—„â”€â”€â”
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚
    pause()   â”‚   resume()â”‚
              â–¼          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
         â”‚ å·²æš‚åœ   â”‚â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
              â”‚ stopExecution()
              â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  å·²åœæ­¢  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. GUIç•Œé¢è®¾è®¡

#### ä¸»çª—å£å¸ƒå±€ (VizVMRLauncher - JavaFX)

**å®é™…å¸ƒå±€ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [èœå•æ ] æ–‡ä»¶ è§†å›¾ è¿è¡Œ å¸®åŠ©                        â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ [å·¥å…·æ ] â–¶ â¸ â¹ â­                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â”‚
â”‚ â”‚ â”‚   å¯„å­˜å™¨      â”‚    ä»£ç        â”‚                     â”‚ â”‚
â”‚ â”‚ â”‚   RegisterView  â”‚   CodeView    â”‚                     â”‚ â”‚
â”‚ â”‚ â”‚               â”‚               â”‚                     â”‚ â”‚
â”‚ â”‚ â”‚  r0: 0x00    â”‚ 0x004: li r1,100                    â”‚ â”‚
â”‚ â”‚ â”‚  r1: 0x64    â”‚ 0x008: add r2,r1,r1               â”‚ â”‚
â”‚ â”‚ â”‚  r2: 0xC8    â”‚ 0x00C: add r3,r2,r1               â”‚ â”‚
â”‚ â”‚ â”‚  ...          â”‚ ...                                  â”‚ â”‚
â”‚ â”‚ â”‚  r15: 0x00    â”‚                                      â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚ â”‚
â”‚ â”‚ â”‚    æ ˆ         â”‚    å†…å­˜        â”‚                     â”‚ â”‚
â”‚ â”‚ â”‚  StackView    â”‚ MemoryView    â”‚                     â”‚ â”‚
â”‚ â”‚ â”‚               â”‚               â”‚                     â”‚ â”‚
â”‚ â”‚ â”‚ Frame 0:     â”‚ 0x0000: 0x12345678                 â”‚ â”‚
â”‚ â”‚ â”‚   main(PC=4) â”‚ 0x0004: 0x9abcdef0                  â”‚ â”‚
â”‚ â”‚ â”‚ Frame 1:     â”‚ 0x0008: 0xdeadbeef                  â”‚ â”‚
â”‚ â”‚ â”‚  func1(PC=24)â”‚ ...                                  â”‚ â”‚
â”‚ â”‚ â”‚ ...          â”‚                                      â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [çŠ¶æ€æ ] çŠ¶æ€: è¿è¡Œä¸­ | PC: 0x0010 | æŒ‡ä»¤: 153      â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ [æ—¥å¿—] [INFO] å¼€å§‹æ‰§è¡Œ                                    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¸ƒå±€å±‚æ¬¡ç»“æ„**:
```mermaid
graph TB
    Root[BorderPane - æ ¹é¢æ¿]
    
    Root --> Top[VBox - é¡¶éƒ¨å®¹å™¨]
    Top --> MenuBar[MenuBar - èœå•æ ]
    Top --> ToolBar[ToolBar - å·¥å…·æ ]
    
    Root --> Center[SplitPane - ä¸­å¤®æ°´å¹³åˆ†å‰² 40% | 60%]
    
    Center --> Left[SplitPane - å·¦ä¾§å‚ç›´åˆ†å‰² 50% | 50%]
    Left --> RegisterView[RegisterView - å¯„å­˜å™¨è§†å›¾]
    Left --> StackView[StackView - è°ƒç”¨æ ˆè§†å›¾]
    
    Center --> Right[SplitPane - å³ä¾§å‚ç›´åˆ†å‰² 50% | 50%]
    Right --> CodeView[CodeView - ä»£ç è§†å›¾]
    Right --> MemoryView[MemoryView - å†…å­˜è§†å›¾]
    
    Root --> Bottom[VBox - åº•éƒ¨å®¹å™¨]
    Bottom --> StatusView[StatusView - çŠ¶æ€è§†å›¾]
    Bottom --> LogView[LogView - æ—¥å¿—è§†å›¾]
    
    style Root fill:#e1f5ff
    style Center fill:#fff3e0
    style Left fill:#fce4ec
    style Right fill:#e8f5e9
```

**ç»„ä»¶è¯´æ˜**:

| åŒºåŸŸ | ç»„ä»¶ | è¯´æ˜ |
|------|------|------|
| èœå•æ  | MenuBar | æ–‡ä»¶(æ‰“å¼€ã€é‡æ–°åŠ è½½ã€é€€å‡º)ã€è§†å›¾(å¯„å­˜å™¨ã€å†…å­˜ã€åˆ·æ–°)ã€è¿è¡Œ(å¼€å§‹ã€æš‚åœã€åœæ­¢ã€å•æ­¥)ã€å¸®åŠ© |
| å·¥å…·æ  | ToolBar | â–¶å¼€å§‹ã€â¸æš‚åœã€â¹åœæ­¢ã€â­å•æ­¥æ‰§è¡Œ |
| å·¦ä¸Š | RegisterView | 4Ã—4ç½‘æ ¼æ˜¾ç¤º16ä¸ªå¯„å­˜å™¨ï¼Œæ”¯æŒé¢œè‰²ç¼–ç  |
| å·¦ä¸‹ | StackView | å‚ç›´åˆ—è¡¨æ˜¾ç¤ºè°ƒç”¨æ ˆå¸§ä¿¡æ¯ |
| å³ä¸Š | CodeView | æ˜¾ç¤ºåæ±‡ç¼–æŒ‡ä»¤ï¼Œæ”¯æŒPCé«˜äº®å’Œæ–­ç‚¹ |
| å³ä¸‹ | MemoryView | å¯æ»šåŠ¨è¡¨æ ¼æ˜¾ç¤ºå †å†…å­˜å’Œå…¨å±€å˜é‡ |
| åº•éƒ¨çŠ¶æ€æ  | StatusView | æ˜¾ç¤ºVMçŠ¶æ€ã€PCã€æŒ‡ä»¤æ•°ã€æ‰§è¡Œæ—¶é—´ã€å½“å‰æŒ‡ä»¤ |
| åº•éƒ¨æ—¥å¿—æ  | LogView | æ˜¾ç¤ºç³»ç»Ÿæ—¥å¿—å’Œæ‰§è¡Œä¿¡æ¯ |

#### ç»„ä»¶è¯¦ç»†è®¾è®¡

##### å¯„å­˜å™¨é¢æ¿ (RegisterPanel)
- **å¸ƒå±€**: 4Ã—4ç½‘æ ¼ï¼Œæ˜¾ç¤º16ä¸ªå¯„å­˜å™¨
- **é¢œè‰²ç¼–ç **:
  - ğŸ”´ çº¢è‰²: æœ€è¿‘ä¿®æ”¹çš„å¯„å­˜å™¨
  - ğŸ”µ è“è‰²: ç‰¹æ®Šå¯„å­˜å™¨ (r13-SP, r14-FP, r15-LR)
  - âšª ç°è‰²: æœªä¿®æ”¹çš„å¯„å­˜å™¨
  - ğŸŸ¢ ç»¿è‰²: é›¶å¯„å­˜å™¨ (r0)
- **æ˜¾ç¤ºæ ¼å¼**: åå…­è¿›åˆ¶ (0x...) + åè¿›åˆ¶ + å­—ç¬¦è¡¨ç¤º
- **äº¤äº’**: åŒå‡»ä¿®æ”¹å€¼ï¼Œå³é”®æŸ¥çœ‹å†å²

##### å†…å­˜é¢æ¿ (MemoryPanel)
- **å¸ƒå±€**: å¯æ»šåŠ¨çš„è¡¨æ ¼ï¼Œæ¯è¡Œæ˜¾ç¤º4ä¸ªå†…å­˜å­—
- **æ˜¾ç¤ºæ¨¡å¼**:
  - åå…­è¿›åˆ¶: `0x12345678`
  - åè¿›åˆ¶: `305419896`
  - ASCII: æ˜¾ç¤ºå¯æ‰“å°å­—ç¬¦ (32-126)
- **åŠŸèƒ½**: åœ°å€æœç´¢ã€è·³è½¬ã€å†…å­˜èŒƒå›´æŸ¥çœ‹

##### ä»£ç é¢æ¿ (CodePanel)
- **åŠŸèƒ½**: æ˜¾ç¤ºåæ±‡ç¼–æŒ‡ä»¤ï¼Œé«˜äº®å½“å‰PC
- **åæ±‡ç¼–å™¨**: ä½¿ç”¨ EP18R çš„ `RegisterDisAssembler`
- **æ ‡è®°**:
  - â— çº¢è‰²åœ†ç‚¹: æ–­ç‚¹
  - ğŸŸ¡ é»„è‰²èƒŒæ™¯: å½“å‰PCä½ç½®
  - ğŸŸ¢ æµ…ç»¿èƒŒæ™¯: å·²æ‰§è¡ŒæŒ‡ä»¤
- **äº¤äº’**: ç‚¹å‡»è®¾ç½®æ–­ç‚¹ï¼Œå³é”®è·³è½¬

##### è°ƒç”¨æ ˆé¢æ¿ (StackPanel)
- **æ˜¾ç¤º**: å‚ç›´åˆ—è¡¨ï¼Œæ˜¾ç¤ºè°ƒç”¨æ ˆå±‚æ¬¡
- **ä¿¡æ¯**: å‡½æ•°åã€è¿”å›åœ°å€ã€å±€éƒ¨å˜é‡æ•°
- **å±•å¼€/æŠ˜å **: æŸ¥çœ‹å±€éƒ¨å˜é‡è¯¦æƒ…
- **å¯¼èˆª**: åŒå‡»è·³è½¬åˆ°è¿”å›åœ°å€

##### æ§åˆ¶é¢æ¿ (ControlPanel)
```java
public class ControlPanel extends JPanel {
    // æ§åˆ¶æŒ‰é’®
    private JButton btnStart;      // â–¶ å¼€å§‹æ‰§è¡Œ
    private JButton btnPause;      // â¸ æš‚åœæ‰§è¡Œ
    private JButton btnStop;       // â¹ åœæ­¢æ‰§è¡Œ
    private JButton btnStep;       // â­ å•æ­¥æ‰§è¡Œ
    private JButton btnStepOver;   // â­â­ å•æ­¥æ­¥è¿‡
    private JButton btnStepOut;    // â­â†— å•æ­¥æ­¥å‡º
    private JButton btnRunToBreak; // â­â— è¿è¡Œåˆ°æ–­ç‚¹
    
    // æ–­ç‚¹ç®¡ç†
    private JButton btnAddBreak;   // +â— æ·»åŠ æ–­ç‚¹
    private JButton btnRemoveBreak;// -â— åˆ é™¤æ–­ç‚¹
    private JButton btnClearBreaks;// Ã—â— æ¸…é™¤æ‰€æœ‰æ–­ç‚¹
}
```

##### çŠ¶æ€é¢æ¿ (StatusPanel)
- **æ‰§è¡Œç»Ÿè®¡**: å·²æ‰§è¡ŒæŒ‡ä»¤æ•°ã€è¿è¡Œæ—¶é—´ã€æŒ‡ä»¤é¢‘ç‡
- **è™šæ‹ŸæœºçŠ¶æ€**: è¿è¡Œä¸­ã€å·²æš‚åœã€å·²åœæ­¢ã€é”™è¯¯
- **æ€§èƒ½æŒ‡æ ‡**: å¹³å‡æŒ‡ä»¤æ—¶é—´ã€å†…å­˜ä½¿ç”¨ç‡
- **é€šçŸ¥åŒºåŸŸ**: æ˜¾ç¤ºè­¦å‘Šã€é”™è¯¯ã€ä¿¡æ¯æ¶ˆæ¯

## ğŸ”Œ ä¸EP18Rçš„é›†æˆæ¥å£

### 1. æ‰©å±• IVirtualMachine æ¥å£
```java
// å»ºè®®åœ¨ EP18R ä¸­æ‰©å±•æ¥å£
public interface IVirtualMachineVisualizable extends IVirtualMachine {
    // ç›‘å¬å™¨ç®¡ç†
    void addStateListener(VMRStateListener listener);
    void removeStateListener(VMRStateListener listener);
    void addExecutionListener(VMRExecutionListener listener);
    void removeExecutionListener(VMRExecutionListener listener);
    
    // çŠ¶æ€è·å–
    int[] getRegisterValues();
    int getProgramCounter();
    StackFrame[] getCallStack();
    byte[] getCodeMemory();
    Object[] getConstantPool();
    
    // æ‰§è¡Œæ§åˆ¶
    void setExecutionMode(ExecutionMode mode);
    void setBreakpoints(Set<Integer> breakpoints);
    void pauseExecution();
    void resumeExecution();
}
```

### 2. å®é™…é›†æˆæ–¹æ¡ˆ
ç”±äºä¸èƒ½ä¿®æ”¹ EP18R æºä»£ç ï¼Œé‡‡ç”¨ **åå°„é€‚é…å™¨æ¨¡å¼**ï¼š

1. **VMRInstrumentation**: é€šè¿‡åå°„è®¿é—®è™šæ‹Ÿæœºå†…éƒ¨çŠ¶æ€
2. **çŠ¶æ€åŒæ­¥**: å®šæœŸåŒæ­¥å¯„å­˜å™¨ã€å†…å­˜ã€è°ƒç”¨æ ˆçŠ¶æ€
3. **äº‹ä»¶è§¦å‘**: åœ¨è™šæ‹Ÿæœºå…³é”®ä½ç½®æ’å…¥äº‹ä»¶è§¦å‘ç‚¹
4. **æ§åˆ¶ä»£ç†**: é€šè¿‡æ¡¥æ¥å™¨æ§åˆ¶è™šæ‹Ÿæœºæ‰§è¡Œæµç¨‹

### 3. æ•°æ®æµ
```
è™šæ‹Ÿæœºæ‰§è¡Œ â†’ çŠ¶æ€å˜åŒ– â†’ äº‹ä»¶è§¦å‘ â†’ ç›‘å¬å™¨é€šçŸ¥ â†’ çŠ¶æ€æ¨¡å‹æ›´æ–° â†’ GUIåˆ·æ–°
    â†‘           â†‘           â†‘           â†‘           â†‘           â†‘
    â”‚           â”‚           â”‚           â”‚           â”‚           â”‚
æ§åˆ¶å‘½ä»¤ â†â”€â”€ ç”¨æˆ·æ“ä½œ â†â”€â”€ GUIäº‹ä»¶ â†â”€â”€ çŠ¶æ€åŒæ­¥ â†â”€â”€ æ¨¡å‹æŸ¥è¯¢ â†â”€â”€ ç•Œé¢æ¸²æŸ“
```

## ğŸ“Š æ•°æ®ç»“æ„è®¾è®¡

### 1. äº‹ä»¶æ•°æ®ç»“æ„
```java
public abstract class VMRStateEvent extends EventObject {
    private final long timestamp;      // äº‹ä»¶æ—¶é—´æˆ³
    private final int stepNumber;      // æ‰§è¡Œæ­¥æ•°
    
    public abstract String getDescription(); // äº‹ä»¶æè¿°
}

public class RegisterChangeEvent extends VMRStateEvent {
    private final int registerIndex;   // å¯„å­˜å™¨ç´¢å¼• (0-15)
    private final int oldValue;        // æ—§å€¼
    private final int newValue;        // æ–°å€¼
    private final String registerName; // å¯„å­˜å™¨åç§° (r0-r15)
}

public class MemoryChangeEvent extends VMRStateEvent {
    private final int address;         // å†…å­˜åœ°å€
    private final int oldValue;        // æ—§å€¼
    private final int newValue;        // æ–°å€¼
    private final MemoryType type;     // å†…å­˜ç±»å‹ (HEAP, GLOBAL, STACK)
}
```

### 2. çŠ¶æ€å¿«ç…§
```java
public class VMRStateSnapshot {
    private final int[] registers;     // å¯„å­˜å™¨å€¼å¿«ç…§
    private final int[] heap;          // å †å†…å­˜å¿«ç…§
    private final int[] globals;       // å…¨å±€å˜é‡å¿«ç…§
    private final StackFrame[] callStack; // è°ƒç”¨æ ˆå¿«ç…§
    private final int programCounter;  // PCå¿«ç…§
    private final long timestamp;      // å¿«ç…§æ—¶é—´
    private final int stepNumber;      // æ‰§è¡Œæ­¥æ•°
    
    // åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ”¯æŒ
    public byte[] serialize() { ... }
    public static VMRStateSnapshot deserialize(byte[] data) { ... }
}
```

## ğŸš€ æ‰§è¡Œæ§åˆ¶è®¾è®¡

### 1. æ‰§è¡Œæ¨¡å¼æšä¸¾
```java
public enum ExecutionMode {
    RUN,                    // è¿ç»­æ‰§è¡Œ
    STEP,                   // å•æ­¥æ‰§è¡Œ
    STEP_OVER,              // å•æ­¥æ­¥è¿‡ï¼ˆé‡åˆ°callæ‰§è¡Œæ•´ä¸ªå‡½æ•°ï¼‰
    STEP_OUT,               // å•æ­¥æ­¥å‡ºï¼ˆæ‰§è¡Œåˆ°å½“å‰å‡½æ•°è¿”å›ï¼‰
    STEP_TO_BREAKPOINT,     // è¿è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹
    PAUSE,                  // æš‚åœæ‰§è¡Œ
    STOP                    // åœæ­¢æ‰§è¡Œ
}
```

### 2. æ–­ç‚¹ç³»ç»Ÿ
```java
public class VMRBreakpointManager {
    private final Set<Integer> breakpoints; // æ–­ç‚¹åœ°å€é›†åˆ
    private final Map<Integer, BreakpointCondition> conditions; // æ¡ä»¶æ–­ç‚¹
    
    public static class BreakpointCondition {
        private final String expression; // æ¡ä»¶è¡¨è¾¾å¼
        private final Predicate<ExecutionContext> predicate; // æ¡ä»¶è°“è¯
        
        public boolean evaluate(ExecutionContext context) {
            return predicate.test(context);
        }
    }
    
    // æ–­ç‚¹å‘½ä¸­æ£€æŸ¥
    public boolean shouldBreak(int pc, ExecutionContext context) {
        return breakpoints.contains(pc) && 
               (conditions.get(pc) == null || conditions.get(pc).evaluate(context));
    }
}
```

### 3. å•æ­¥æ‰§è¡Œæ§åˆ¶å™¨
```java
public class VMRStepController {
    private ExecutionMode currentMode = ExecutionMode.PAUSE;
    private final VMRVisualBridge bridge;
    private final VMRBreakpointManager breakpointManager;
    
    public void step() {
        if (currentMode == ExecutionMode.STEP) {
            bridge.executeSingleInstruction();
        } else if (currentMode == ExecutionMode.STEP_OVER) {
            executeStepOver();
        } else if (currentMode == ExecutionMode.STEP_OUT) {
            executeStepOut();
        }
    }
    
    private void executeStepOver() {
        int currentDepth = bridge.getCallStackDepth();
        do {
            bridge.executeSingleInstruction();
        } while (bridge.getCallStackDepth() > currentDepth);
    }
}
```

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡åŸåˆ™

### 1. å“åº”å¼è®¾è®¡
- **å®æ—¶æ›´æ–°**: çŠ¶æ€å˜åŒ–ç«‹å³åæ˜ åˆ°ç•Œé¢
- **æ€§èƒ½ä¼˜åŒ–**: æ‰¹å¤„ç†æ›´æ–°ï¼Œé¿å…é¢‘ç¹é‡ç»˜
- **çº¿ç¨‹å®‰å…¨**: Swing æ›´æ–°åœ¨ EDT ä¸­æ‰§è¡Œ

### 2. å¯ç”¨æ€§åŸåˆ™
- **ä¸€è‡´æ€§**: éµå¾ª Java Swing è®¾è®¡è§„èŒƒ
- **åé¦ˆ**: ç”¨æˆ·æ“ä½œç«‹å³å¾—åˆ°è§†è§‰åé¦ˆ
- **å®¹é”™**: é”™è¯¯å¤„ç†å’Œä¼˜é›…é™çº§

### 3. å¯è®¿é—®æ€§
- **é”®ç›˜å¯¼èˆª**: æ”¯æŒå¸¸ç”¨å¿«æ·é”®
- **é«˜å¯¹æ¯”åº¦**: æ”¯æŒè‰²ç›²å‹å¥½é…è‰²æ–¹æ¡ˆ
- **ç¼©æ”¾æ”¯æŒ**: ç•Œé¢å…ƒç´ å¯ç¼©æ”¾

### 4. ä¸»é¢˜æ”¯æŒ
```java
public enum VMRTheme {
    LIGHT("Light"),      // äº®è‰²ä¸»é¢˜
    DARK("Dark"),        // æš—è‰²ä¸»é¢˜
    CLASSIC("Classic"),  // ç»å…¸ä¸»é¢˜ï¼ˆç±»ä¼¼IDEï¼‰
    HIGH_CONTRAST("High Contrast"); // é«˜å¯¹æ¯”åº¦ä¸»é¢˜
}
```

## ğŸ”§ é…ç½®ç®¡ç†

### 1. é…ç½®æ–‡ä»¶æ ¼å¼ (JSON)
```json
{
  "window": {
    "width": 1200,
    "height": 800,
    "maximized": false,
    "position": {"x": 100, "y": 100}
  },
  "theme": "CLASSIC",
  "updateInterval": 100,
  "maxHistorySize": 1000,
  "breakpoints": [0x100, 0x200, 0x300],
  "showHexValues": true,
  "showDecimalValues": true,
  "showAsciiValues": false
}
```

### 2. é…ç½®ç®¡ç†ç±»
```java
public class VMRConfig {
    private int windowWidth;
    private int windowHeight;
    private boolean windowMaximized;
    private Point windowPosition;
    private VMRTheme theme;
    private int updateInterval;
    private int maxHistorySize;
    private Set<Integer> breakpoints;
    private boolean showHexValues;
    private boolean showDecimalValues;
    private boolean showAsciiValues;
    
    // é…ç½®åŠ è½½å’Œä¿å­˜
    public void loadFromFile(String path) { ... }
    public void saveToFile(String path) { ... }
    public void applyToUI(MainFrame frame) { ... }
}
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
- **äº‹ä»¶ç³»ç»Ÿ**: æµ‹è¯•äº‹ä»¶åˆ›å»ºã€åˆ†å‘ã€å¤„ç†
- **çŠ¶æ€æ¨¡å‹**: æµ‹è¯•çŠ¶æ€æ›´æ–°ã€é€šçŸ¥ã€åºåˆ—åŒ–
- **å·¥å…·ç±»**: æµ‹è¯•æ ¼å¼åŒ–ã€é¢œè‰²ç®¡ç†ã€èµ„æºåŠ è½½

### 2. é›†æˆæµ‹è¯•
- **è™šæ‹Ÿæœºé›†æˆ**: æµ‹è¯•ä¸ EP18R çš„é›†æˆ
- **GUIé›†æˆ**: æµ‹è¯•ç»„ä»¶ååŒå·¥ä½œ
- **ç«¯åˆ°ç«¯æµ‹è¯•**: å®Œæ•´å·¥ä½œæµæµ‹è¯•

### 3. UIæµ‹è¯•
- **åŠŸèƒ½æµ‹è¯•**: æµ‹è¯•æŒ‰é’®ç‚¹å‡»ã€èœå•æ“ä½œ
- **å¯è§†åŒ–æµ‹è¯•**: æµ‹è¯•æ¸²æŸ“æ­£ç¡®æ€§
- **äº¤äº’æµ‹è¯•**: æµ‹è¯•ç”¨æˆ·äº¤äº’æµç¨‹

### 4. æ€§èƒ½æµ‹è¯•
- **å†…å­˜ä½¿ç”¨**: ç›‘æ§å†…å­˜æ³„æ¼
- **å“åº”æ—¶é—´**: æµ‹è¯•ç•Œé¢å“åº”é€Ÿåº¦
- **å¹¶å‘æµ‹è¯•**: æµ‹è¯•å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„ç¨³å®šæ€§

## ğŸ”„ éƒ¨ç½²å’Œç»´æŠ¤

### 1. æ„å»ºé…ç½® (Maven)
```xml
<dependencies>
    <dependency>
        <groupId>org.teachfx</groupId>
        <artifactId>ep18r</artifactId>
        <version>1.0.0</version>
    </dependency>
</dependencies>
```

### 2. è¿è¡Œè¦æ±‚
- **Javaç‰ˆæœ¬**: JDK 21+
- **å†…å­˜è¦æ±‚**: æœ€å° 512MBï¼Œæ¨è 1GB
- **å±å¹•åˆ†è¾¨ç‡**: æœ€å° 1024Ã—768ï¼Œæ¨è 1280Ã—1024

### 3. æ‰“åŒ…å‘å¸ƒ
- **JARæ‰“åŒ…**: åŒ…å«æ‰€æœ‰ä¾èµ–
- **å¯åŠ¨è„šæœ¬**: æä¾›è·¨å¹³å°å¯åŠ¨è„šæœ¬
- **å®‰è£…ç¨‹åº**: å¯é€‰å®‰è£…ç¨‹åºï¼ˆæœªæ¥ç‰ˆæœ¬ï¼‰

## ğŸ“ˆ æœªæ¥æ‰©å±•

### 1. åŠŸèƒ½æ‰©å±•
- **æ€§èƒ½åˆ†æå™¨**: æŒ‡ä»¤é¢‘ç‡åˆ†æã€çƒ­ç‚¹è¯†åˆ«
- **å†…å­˜åˆ†æå™¨**: å†…å­˜æ³„æ¼æ£€æµ‹ã€ä½¿ç”¨æ¨¡å¼åˆ†æ
- **ä»£ç è¦†ç›–**: æ‰§è¡Œè·¯å¾„è¦†ç›–åˆ†æ
- **åç¼–è¯‘å™¨**: é«˜çº§åæ±‡ç¼–å’Œä»£ç åˆ†æ

### 2. æŠ€æœ¯å‡çº§

## ğŸš€ JavaFX è¿ç§»è®¡åˆ’

### 1. è¿ç§»èƒŒæ™¯

#### 1.1 è¿ç§»åŸå› 

**æŠ€æœ¯å±‚é¢**:
- **Swingå·²å¼ƒç”¨**: Oracleå·²å®£å¸ƒSwingè¿›å…¥ç»´æŠ¤æ¨¡å¼ï¼Œä¸å†æ·»åŠ æ–°åŠŸèƒ½
- **æ€§èƒ½å·®å¼‚**: JavaFXä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿï¼Œåœ¨ç°ä»£ç¡¬ä»¶ä¸Šæ€§èƒ½æ›´ä¼˜ï¼ˆåŸºå‡†æµ‹è¯•æ˜¾ç¤º12-37%æå‡ï¼‰
- **CSSæ”¯æŒ**: JavaFXåŸç”Ÿæ”¯æŒCSSæ ·å¼ï¼ŒåŠ¨ç”»æ•ˆæœæ›´æµç•…
- **Webé›†æˆ**: JavaFXå†…ç½®WebViewï¼Œæ”¯æŒæœªæ¥Webå¯è§†åŒ–æ‰©å±•

**ç¤¾åŒºå±‚é¢**:
- **æ´»è·ƒåº¦**: JavaFXç¤¾åŒºæ›´æ´»è·ƒï¼Œç¬¬ä¸‰æ–¹åº“æ›´ä¸°å¯Œ
- **æ–‡æ¡£**: å®˜æ–¹æ–‡æ¡£æ›´å®Œå–„ï¼Œè¿ç§»æŒ‡å—è¯¦å°½
- **å·¥å…·**: Scene Builderç­‰ä¸“ä¸šå·¥å…·æ”¯æŒ

#### 1.2 å…¼å®¹æ€§ç¡®è®¤

**Javaç‰ˆæœ¬**: Java 21
**JavaFXç‰ˆæœ¬**: JavaFX 21.0.9 LTS (æ¨è) æˆ– JavaFX 23+ (æœ€æ–°)
**ä¾èµ–é…ç½®**:

```xml
<properties>
    <javafx.version>21.0.9</javafx.version>
</properties>

<dependencies>
    <dependency>
        <groupId>org.openjfx</groupId>
        <artifactId>javafx-controls</artifactId>
        <version>${javafx.version}</version>
    </dependency>
    <dependency>
        <groupId>org.openjfx</groupId>
        <artifactId>javafx-fxml</artifactId>
        <version>${javafx.version}</version>
    </dependency>
    <dependency>
        <groupId>org.openjfx</groupId>
        <artifactId>javafx-graphics</artifactId>
        <version>${javafx.version}</version>
    </dependency>
</dependencies>
```

### 2. è¿ç§»ç­–ç•¥

#### 2.1 æ¸è¿›å¼è¿ç§»

é‡‡ç”¨å¢é‡è¿ç§»ç­–ç•¥ï¼Œä¿æŒSwingç‰ˆæœ¬ä½œä¸ºåå¤‡ï¼š

1. **ç¬¬ä¸€é˜¶æ®µ**: åˆ›å»ºJavaFXåŸºç¡€è®¾æ–½ï¼ˆåŸºç±»ã€äº‹ä»¶é€‚é…å™¨ï¼‰
2. **ç¬¬äºŒé˜¶æ®µ**: è¿ç§»ä¸»çª—å£æ¡†æ¶
3. **ç¬¬ä¸‰é˜¶æ®µ**: è¿ç§»é¢æ¿ç»„ä»¶
4. **ç¬¬å››é˜¶æ®µ**: æµ‹è¯•å’Œä¼˜åŒ–

#### 2.2 ç»„ä»¶æ˜ å°„

| Swingç»„ä»¶ | JavaFXå¯¹åº” | è¿ç§»å¤æ‚åº¦ |
|-----------|------------|------------|
| JFrame | Stage | ä¸­ |
| JPanel | Pane/Region | ä¸­ |
| JButton | Button | ä½ |
| JLabel | Label | ä½ |
| JTable | TableView | ä¸­ |
| JMenuBar | MenuBar | ä½ |
| JToolBar | ToolBar | ä½ |
| JSplitPane | SplitPane | ä½ |
| JOptionPane | Alert/Dialog | ä¸­ |
| JFileChooser | FileChooser | ä¸­ |

### 3. æ¶æ„å˜æ›´

#### 3.1 å½“å‰æ¶æ„ (Swing)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MainFrame (JFrame)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MenuBar  â”‚  â”‚   JSplitPane Hierarchy       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚               â”‚  â”‚ Registerâ”‚  â”‚  Code    â”‚  â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  Panel  â”‚  â”‚  Panel   â”‚  â”‚ â”‚
â”‚ â”‚ ToolBar  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2 ç›®æ ‡æ¶æ„ (JavaFX)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PrimaryStage (Stage)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MenuBar  â”‚  â”‚   BorderPane Layout          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚               â”‚  â”‚ Registerâ”‚  â”‚  Code    â”‚  â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  View   â”‚  â”‚  View    â”‚  â”‚ â”‚
â”‚ â”‚ ToolBar  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3 æ–‡ä»¶ç»“æ„

```
vizvmr/src/main/java/org/teachfx/antlr4/ep18r/vizvmr/
â”œâ”€â”€ VizVMRLauncher.java           # ä¿®æ”¹: æ”¯æŒåŒæ¡†æ¶
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ MainFrame.java            # ä¿ç•™: Swingç‰ˆæœ¬(åå¤‡)
â”‚   â”œâ”€â”€ javafx/
â”‚   â”‚   â”œâ”€â”€ MainStage.fxml        # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ MainStageController.java # æ–°å¢: FXMLæ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ RegisterView.java     # æ–°å¢: JavaFXç‰ˆå¯„å­˜å™¨
â”‚   â”‚   â”œâ”€â”€ RegisterView.fxml     # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ ControlView.java      # æ–°å¢: JavaFXç‰ˆæ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ ControlView.fxml      # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ MemoryView.java       # æ–°å¢: JavaFXç‰ˆå†…å­˜
â”‚   â”‚   â”œâ”€â”€ MemoryView.fxml       # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ CodeView.java         # æ–°å¢: JavaFXç‰ˆä»£ç 
â”‚   â”‚   â”œâ”€â”€ CodeView.fxml         # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ StackView.java        # æ–°å¢: JavaFXç‰ˆè°ƒç”¨æ ˆ
â”‚   â”‚   â”œâ”€â”€ StackView.fxml        # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ StatusView.java       # æ–°å¢: JavaFXç‰ˆçŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ StatusView.fxml       # æ–°å¢: FXMLå¸ƒå±€
â”‚   â”‚   â””â”€â”€ LogView.java          # æ–°å¢: JavaFXç‰ˆæ—¥å¿—
â”‚   â”‚   â””â”€â”€ LogView.fxml          # æ–°å¢: FXMLå¸ƒå±€
â”‚   â””â”€â”€ panel/                    # ä¿ç•™: Swingç‰ˆæœ¬
â””â”€â”€ integration/
    â””â”€â”€ VMRVisualBridge.java      # ä¿®æ”¹: æ”¯æŒåŒUIæ¡†æ¶
```

### 4. å…³é”®æŠ€æœ¯ç‚¹

#### 4.1 çº¿ç¨‹æ¨¡å‹è°ƒæ•´

**Swingæ¨¡å¼**:
```java
SwingUtilities.invokeLater(() -> {
    // UIæ›´æ–°ä»£ç 
});
```

**JavaFXæ¨¡å¼**:
```java
Platform.runLater(() -> {
    // UIæ›´æ–°ä»£ç 
});
```

#### 4.2 äº‹ä»¶å¤„ç†è½¬æ¢

**Swingæ¨¡å¼**:
```java
button.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        // å¤„ç†äº‹ä»¶
    }
});
```

**JavaFXæ¨¡å¼**:
```java
button.setOnAction(event -> {
    // å¤„ç†äº‹ä»¶
});
```

#### 4.3 CSSæ ·å¼æ”¯æŒ

```css
/* styles.css */
.register-cell {
    -fx-background-color: #DCDCDC;
    -fx-padding: 5px;
    -fx-border-color: #A9A9A9;
}

.register-modified {
    -fx-background-color: #FFB6C1;
}

.register-special {
    -fx-background-color: #ADD8E6;
}
```

```java
// åœ¨Javaä»£ç ä¸­åŠ è½½CSS
scene.getStylesheets().add(
    getClass().getResource("/css/vizvmr.css").toExternalForm()
);
```

#### 4.4 FXMLå¸ƒå±€ç¤ºä¾‹

```xml
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.RowConstraints?>

<GridPane xmlns="http://javafx.com/javafx/21.0.3"
          xmlns:fx="http://javafx.com/fxml/1"
          fx:controller="org.teachfx.antlr4.ep18r.vizvmr.ui.javafx.RegisterViewController"
          fx:id="rootPane"
          hgap="5" vgap="5">
    
    <columnConstraints>
        <ColumnConstraints percentWidth="25"/>
        <ColumnConstraints percentWidth="25"/>
        <ColumnConstraints percentWidth="25"/>
        <ColumnConstraints percentWidth="25"/>
    </columnConstraints>
    
    <rowConstraints>
        <RowConstraints percentHeight="25"/>
        <RowConstraints percentHeight="25"/>
        <RowConstraints percentHeight="25"/>
        <RowConstraints percentHeight="25"/>
    </rowConstraints>
    
</GridPane>
```

### 5. è¿ç§»æ—¶é—´è¡¨

#### é˜¶æ®µä¸€ï¼šåŸºç¡€è®¾æ–½ (ç¬¬1å‘¨)
- [ ] æ·»åŠ JavaFXä¾èµ–åˆ°POM
- [ ] åˆ›å»ºJavaFXåŸºç±»JFXPanelBase
- [ ] åˆ›å»ºäº‹ä»¶é€‚é…å™¨JFXEventAdapter
- [ ] é…ç½®æ¨¡å—è·¯å¾„

#### é˜¶æ®µäºŒï¼šæ ¸å¿ƒæ¡†æ¶ (ç¬¬2-3å‘¨)
- [ ] è¿ç§»MainFrame â†’ MainStage
- [ ] è¿ç§»èœå•ç³»ç»Ÿ
- [ ] è¿ç§»å·¥å…·æ 
- [ ] è¿ç§»å¸ƒå±€ç®¡ç†å™¨

#### é˜¶æ®µä¸‰ï¼šé¢æ¿ç»„ä»¶ (ç¬¬4-6å‘¨)
- [ ] è¿ç§»RegisterPanel (é«˜ä¼˜å…ˆçº§)
- [ ] è¿ç§»ControlPanel (é«˜ä¼˜å…ˆçº§)
- [ ] è¿ç§»StatusPanel (é«˜ä¼˜å…ˆçº§)
- [ ] è¿ç§»CodePanel (ä¸­ä¼˜å…ˆçº§)
- [ ] è¿ç§»MemoryPanel (ä¸­ä¼˜å…ˆçº§)
- [ ] è¿ç§»StackPanel (ä¸­ä¼˜å…ˆçº§)
- [ ] è¿ç§»LogPanel (ä½ä¼˜å…ˆçº§)

#### é˜¶æ®µå››ï¼šæµ‹è¯•ä¼˜åŒ– (ç¬¬7-8å‘¨)
- [ ] åˆ›å»ºTestFXæµ‹è¯•ç”¨ä¾‹
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- [ ] ç«¯åˆ°ç«¯é›†æˆæµ‹è¯•

### 6. å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

#### 6.1 macOS 14 Sonomaçª—å£æ¿€æ´»
**é—®é¢˜**: åº”ç”¨çª—å£æ— æ³•æ­£ç¡®æ¿€æ´»
**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨JavaFX 21.0.2æˆ–æ›´æ–°ç‰ˆæœ¬

#### 6.2 Linux GTK 3ä¾èµ–
**é—®é¢˜**: JavaFX 21éœ€è¦GTK 3
**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿Linuxç³»ç»Ÿå®‰è£…GTK 3.8+
```bash
sudo apt-get install libgtk-3-dev libwebkit2gtk-4.0-dev
```

#### 6.3 æ€§èƒ½å›å½’
**é—®é¢˜**: CSSæ¸²æŸ“æ€§èƒ½é—®é¢˜
**è§£å†³æ–¹æ¡ˆ**: æ›´æ–°åˆ°JavaFX 21.0.9ï¼ˆåŒ…å«æ€§èƒ½ä¿®å¤ï¼‰

### 7. æµ‹è¯•ç­–ç•¥

#### 7.1 å•å…ƒæµ‹è¯•
ä¿æŒç°æœ‰JUnitæµ‹è¯•è¦†ç›–ä¸šåŠ¡é€»è¾‘ã€‚

#### 7.2 UIæµ‹è¯•
ä½¿ç”¨TestFXæ›¿ä»£AssertJ-Swingï¼š

```java
@Test
public void testRegisterUpdate() {
    RegisterViewController controller = new RegisterViewController(visualBridge);
    
    controller.updateRegister(0, 100);
    
    // éªŒè¯UIæ›´æ–°
    verify(registerLabel).setText("0x00000064 (100)");
}
```

#### 7.3 æ€§èƒ½æµ‹è¯•
ä½¿ç”¨JMHè¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼š

```java
@Benchmark
@BenchmarkMode(Mode.AverageTime)
public void registerUpdateBenchmark() {
    controller.updateRegister(0, randomValue());
}
```

### 8. å›æ»šè®¡åˆ’

#### 8.1 å¿«é€Ÿå›æ»šæœºåˆ¶
- ä¿ç•™Swingç‰ˆæœ¬ä½œä¸ºåå¤‡
- ä½¿ç”¨ç‰¹æ€§å¼€å…³åˆ‡æ¢UIæ¡†æ¶
- é…ç½®æ–‡ä»¶æ§åˆ¶é»˜è®¤æ¡†æ¶

#### 8.2 å›æ»šè§¦å‘æ¡ä»¶
- å…³é”®åŠŸèƒ½æµ‹è¯•å¤±è´¥
- æ€§èƒ½ä¸‹é™è¶…è¿‡10%
- å†…å­˜ä½¿ç”¨å¢åŠ è¶…è¿‡20%

### 9. éªŒæ”¶æ ‡å‡†

#### åŠŸèƒ½éªŒæ”¶
- [ ] æ‰€æœ‰ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] äº‹ä»¶ç³»ç»Ÿå…¼å®¹æ€§å®Œæ•´
- [ ] æ–­ç‚¹å’Œå•æ­¥æ‰§è¡ŒåŠŸèƒ½æ­£å¸¸
- [ ] æ–‡ä»¶åŠ è½½å’Œä¿å­˜åŠŸèƒ½æ­£å¸¸

#### æ€§èƒ½éªŒæ”¶
- [ ] UIå“åº”æ—¶é—´ < 100ms
- [ ] å†…å­˜ä½¿ç”¨ç¨³å®š
- [ ] äº‹ä»¶å¤„ç†å»¶è¿Ÿ < 10ms

#### å…¼å®¹æ€§éªŒæ”¶
- [ ] åœ¨Windows/Linux/macOSä¸Šæ­£å¸¸è¿è¡Œ
- [ ] é”®ç›˜å¿«æ·é”®æ­£å¸¸å·¥ä½œ
- [ ] ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½æ­£å¸¸

- **JavaFXè¿ç§»**: ä» Swing è¿ç§»åˆ° JavaFX
- **Webç‰ˆæœ¬**: åŸºäº Web çš„å¯è§†åŒ–ç•Œé¢
- **æ’ä»¶ç³»ç»Ÿ**: æ”¯æŒç¬¬ä¸‰æ–¹æ’ä»¶æ‰©å±•

### 3. é›†æˆæ‰©å±•
- **IDEé›†æˆ**: ä½œä¸º IDE æ’ä»¶
- **æ•™å­¦å¹³å°**: é›†æˆåˆ°åœ¨çº¿æ•™å­¦å¹³å°
- **CI/CDé›†æˆ**: è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒéªŒè¯

## ğŸ“ è®¾è®¡å†³ç­–è®°å½•

### 1. æ¶æ„å†³ç­–
- **é€‰æ‹©Java Swing**: æ ‡å‡†åº“ï¼Œæ— é¢å¤–ä¾èµ–ï¼Œæˆç†Ÿç¨³å®š
- **è§‚å¯Ÿè€…æ¨¡å¼**: æ¾è€¦åˆï¼Œæ˜“äºæ‰©å±•
- **åå°„é€‚é…å™¨**: ä¸ä¿®æ”¹ EP18R æºä»£ç ï¼Œä¿æŒæ¨¡å—ç‹¬ç«‹

### 2. æ€§èƒ½å†³ç­–
- **æ‰¹å¤„ç†æ›´æ–°**: å‡å°‘äº‹ä»¶é€šçŸ¥é¢‘ç‡
- **æ‡’åŠ è½½**: æŒ‰éœ€åŠ è½½åæ±‡ç¼–å’Œæ ¼å¼åŒ–æ•°æ®
- **ç¼“å­˜æœºåˆ¶**: ç¼“å­˜é¢‘ç¹è®¿é—®çš„æ•°æ®

### 3. ç”¨æˆ·ä½“éªŒå†³ç­–
- **å¤šä¸»é¢˜æ”¯æŒ**: é€‚åº”ä¸åŒç”¨æˆ·åå¥½
- **å¿«æ·é”®**: æé«˜ä¸“å®¶ç”¨æˆ·æ•ˆç‡
- **æ¸è¿›å¼æŠ«éœ²**: é«˜çº§åŠŸèƒ½é»˜è®¤éšè—

---

## ğŸ”„ äº‹ä»¶æ‰§è¡Œæµç¨‹åˆ†æ

### æ¦‚è¿°

vizvmr é‡‡ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œé€šè¿‡è§‚å¯Ÿè€…æ¨¡å¼å®ç°è™šæ‹ŸæœºçŠ¶æ€å˜åŒ–åˆ° UI ç»„ä»¶çš„å®æ—¶æ›´æ–°ã€‚äº‹ä»¶æµä»è™šæ‹Ÿæœºæ‰§è¡Œå¼€å§‹ï¼Œç»è¿‡æ¡¥æ¥å™¨ã€çŠ¶æ€æ¨¡å‹ï¼Œæœ€ç»ˆä¼ æ’­åˆ°å„ä¸ª UI ç»„ä»¶ã€‚

### æ ¸å¿ƒäº‹ä»¶ç±»å‹

| äº‹ä»¶ç±»å‹ | æ¥å£ | è§¦å‘æ—¶æœº | ç›‘å¬å™¨ |
|---------|------|---------|---------|
| **å¯„å­˜å™¨å˜åŒ–** | `RegisterChangeEvent` | å¯„å­˜å™¨å€¼è¢«ä¿®æ”¹ | `VMRStateListener` |
| **å†…å­˜å˜åŒ–** | `MemoryChangeEvent` | å †/å…¨å±€å˜é‡è¢«ä¿®æ”¹ | `VMRStateListener` |
| **PCå˜åŒ–** | `PCChangeEvent` | ç¨‹åºè®¡æ•°å™¨æ›´æ–° | `VMRStateListener` |
| **VMçŠ¶æ€å˜åŒ–** | `VMStateChangeEvent` | VMæ‰§è¡ŒçŠ¶æ€æ”¹å˜ | `VMRStateListener`, `VMRExecutionListener` |
| **æŒ‡ä»¤æ‰§è¡Œ** | `InstructionExecutionEvent` | æŒ‡ä»¤æ‰§è¡Œå®Œæˆ | `VMRExecutionListener` |
| **æ‰§è¡Œé”™è¯¯** | `Throwable` + PC | æ‰§è¡Œå¼‚å¸¸å‘ç”Ÿ | `VMRExecutionListener` |

---

## ğŸ¤– å…³é”® UI ç»„ä»¶çŠ¶æ€æœº

### 1. VMRVisualBridge çŠ¶æ€æœº

**èŒè´£**: ä½œä¸ºä¸­å¤®æ‰§è¡Œåè°ƒå™¨ï¼Œè¿æ¥è™šæ‹Ÿæœºå’Œå¯è§†åŒ–ç•Œé¢

```mermaid
stateDiagram-v2
    [*] --> CREATED: åˆå§‹åŒ–
    CREATED --> LOADED: loadCode()
    LOADED --> RUNNING: start()
    RUNNING --> PAUSED: pause()
    PAUSED --> RUNNING: resume()
    RUNNING --> STEPPING: step()
    STEPPING --> RUNNING: æŒ‡ä»¤å®Œæˆ
    RUNNING --> HALTED: stop()
    PAUSED --> HALTED: stop()
    HALTED --> LOADED: é‡æ–°åŠ è½½ä»£ç 

    note right of CREATED
        VMåˆå§‹åŒ–å®Œæˆ
    end note

    note right of RUNNING
        VMæ‰§è¡ŒæŒ‡ä»¤ä¸­
    end note

    note right of PAUSED
        VMæš‚åœç­‰å¾…ç”¨æˆ·æ“ä½œ
    end note

    note right of HALTED
        VMåœæ­¢æ‰§è¡Œ
    end note

    note right of STEPPING
        å•æ­¥æ‰§è¡Œæ¨¡å¼
    end note
```

**çŠ¶æ€è½¬æ¢è¡¨**:

| å½“å‰çŠ¶æ€ | è§¦å‘äº‹ä»¶ | ç›®æ ‡çŠ¶æ€ | æ¡ä»¶ |
|---------|---------|---------|------|
| CREATED | loadCode() | LOADED | ä»£ç åŠ è½½æˆåŠŸ |
| LOADED | start() | RUNNING | VMå¯åŠ¨ |
| RUNNING | pause() | PAUSED | ç”¨æˆ·è¯·æ±‚æš‚åœ |
| PAUSED | resume() | RUNNING | ç”¨æˆ·è¯·æ±‚ç»§ç»­ |
| RUNNING | step() | STEPPING | å•æ­¥æ‰§è¡Œæ¨¡å¼ |
| STEPPING | (æŒ‡ä»¤å®Œæˆ) | RUNNING | è¿”å›è¿ç»­æ‰§è¡Œ |
| RUNNING | stop() | HALTED | åœæ­¢æ‰§è¡Œ |
| PAUSED | stop() | HALTED | åœæ­¢æ‰§è¡Œ |
| HALTED | loadCode() | LOADED | é‡æ–°åŠ è½½ä»£ç  |

**çŠ¶æ€å±æ€§**:
- `running`: AtomicBoolean - VMæ˜¯å¦è¿è¡Œä¸­
- `paused`: AtomicBoolean - VMæ˜¯å¦æš‚åœ
- `executionThread`: Thread - VMæ‰§è¡Œçº¿ç¨‹

---

### 2. VMRStateModel çŠ¶æ€æœº

**èŒè´£**: ç®¡ç†è™šæ‹Ÿæœºæ‰€æœ‰çŠ¶æ€ï¼Œæä¾›çŠ¶æ€å˜æ›´é€šçŸ¥

```mermaid
stateDiagram-v2
    [*] --> CREATED: åˆå§‹åŒ–å®Œæˆ
    CREATED --> LOADED: ä»£ç åŠ è½½
    LOADED --> RUNNING: å¼€å§‹æ‰§è¡Œ
    RUNNING --> PAUSED: æš‚åœè¯·æ±‚
    PAUSED --> RUNNING: æ¢å¤æ‰§è¡Œ
    RUNNING --> STEPPING: å•æ­¥æ‰§è¡Œ
    STEPPING --> RUNNING: å®Œæˆå•æ­¥
    RUNNING --> HALTED: åœæ­¢æ‰§è¡Œ

    CREATED --> ERROR: æ‰§è¡Œå¼‚å¸¸
    LOADED --> ERROR: æ‰§è¡Œå¼‚å¸¸
    RUNNING --> ERROR: æ‰§è¡Œå¼‚å¸¸
    PAUSED --> ERROR: æ‰§è¡Œå¼‚å¸¸
    STEPPING --> ERROR: æ‰§è¡Œå¼‚å¸¸
    HALTED --> ERROR: æ‰§è¡Œå¼‚å¸¸

    note right of CREATED
        VMçŠ¶æ€æ¨¡å‹å·²åˆ›å»º
    end note

    note right of RUNNING
        VMæ­£åœ¨æ‰§è¡ŒæŒ‡ä»¤
        è§¦å‘: vmStateChanged(LOADED, RUNNING)
    end note

    note right of ERROR
        æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸
        è§¦å‘: vmStateChanged(old, ERROR)
    end note
```

**çŠ¶æ€äº‹ä»¶è§¦å‘**:

| çŠ¶æ€è½¬æ¢ | è§¦å‘äº‹ä»¶ | ç›‘å¬å™¨é€šçŸ¥ |
|---------|---------|-----------|
| CREATED â†’ LOADED | loadCode()å®Œæˆ | vmStateChanged(CREATED, LOADED) |
| LOADED â†’ RUNNING | å¼€å§‹æ‰§è¡Œ | vmStateChanged(LOADED, RUNNING) |
| RUNNING â†’ PAUSED | æš‚åœè¯·æ±‚ | vmStateChanged(RUNNING, PAUSED) |
| PAUSED â†’ RUNNING | æ¢å¤æ‰§è¡Œ | vmStateChanged(PAUSED, RUNNING) |
| RUNNING â†’ HALTED | åœæ­¢æ‰§è¡Œ | vmStateChanged(RUNNING, HALTED) |
| ä»»æ„ â†’ ERROR | æ‰§è¡Œå¼‚å¸¸ | vmStateChanged(old, ERROR) |

**æ•°æ®å˜åŒ–äº‹ä»¶**:

| æ“ä½œ | è§¦å‘äº‹ä»¶ | äº‹ä»¶å‚æ•° |
|------|---------|---------|
| setRegister() | registerChanged() | RegisterChangeEvent(å¯„å­˜å™¨ç´¢å¼•, æ—§å€¼, æ–°å€¼) |
| writeHeap() | memoryChanged() | MemoryChangeEvent(HEAP, åœ°å€, æ—§å€¼, æ–°å€¼) |
| writeGlobal() | memoryChanged() | MemoryChangeEvent(GLOBAL, åœ°å€, æ—§å€¼, æ–°å€¼) |
| setProgramCounter() | pcChanged() | PCChangeEvent(æ—§PC, æ–°PC) |
| æŒ‡ä»¤æ‰§è¡Œå®Œæˆ | afterInstructionExecute() | InstructionExecutionEvent(PC, æ“ä½œç , åŠ©è®°ç¬¦, æ“ä½œæ•°) |

**ç›‘å¬å™¨ç®¡ç†**:
- `addStateListener()`: æ³¨å†ŒçŠ¶æ€ç›‘å¬å™¨ - CopyOnWriteArrayList (çº¿ç¨‹å®‰å…¨)
- `addExecutionListener()`: æ³¨å†Œæ‰§è¡Œç›‘å¬å™¨ - CopyOnWriteArrayList (çº¿ç¨‹å®‰å…¨)
- `removeStateListener()`: ç§»é™¤çŠ¶æ€ç›‘å¬å™¨
- `removeExecutionListener()`: ç§»é™¤æ‰§è¡Œç›‘å¬å™¨

**çŠ¶æ€å¿«ç…§**:
- `createSnapshot()`: åˆ›å»ºå½“å‰çŠ¶æ€å¿«ç…§ - VMRStateSnapshot
- `restoreSnapshot()`: ä»å¿«ç…§æ¢å¤çŠ¶æ€ - æ¢å¤å¯„å­˜å™¨ã€å†…å­˜ã€æ ˆã€PCç­‰

---

### 3. RegisterView çŠ¶æ€æœº

**èŒè´£**: æ˜¾ç¤º16ä¸ªå¯„å­˜å™¨å€¼ï¼Œæ”¯æŒé¢œè‰²ç¼–ç å’Œé«˜äº®

```mermaid
stateDiagram-v2
    [*] --> IDLE: åˆå§‹åŒ–UI
    IDLE --> ACTIVE: UIå°±ç»ª
    ACTIVE --> REFRESHING: refresh()
    REFRESHING --> ACTIVE: åˆ·æ–°å®Œæˆ
    ACTIVE --> HIGHLIGHTED: highlightRegister()
    HIGHLIGHTED --> ACTIVE: æ¸…é™¤é«˜äº®

    note right of ACTIVE
        å¯„å­˜å™¨æ˜¾ç¤ºæ­£å¸¸
    end note

    note right of REFRESHING
        æ­£åœ¨æ›´æ–°å¯„å­˜å™¨å€¼
    end note

    note right of HIGHLIGHTED
        å¯„å­˜å™¨é«˜äº®æ˜¾ç¤º
    end note
```

**æ¯ä¸ªå¯„å­˜å™¨å•å…ƒæ ¼çŠ¶æ€**:

```mermaid
stateDiagram-v2
    [*] --> NORMAL: åˆå§‹åŒ–
    NORMAL --> MODIFIED: setRegister()å€¼æ”¹å˜
    MODIFIED --> NORMAL: åˆ·æ–°åé‡ç½®
    NORMAL --> ZERO: r0 (é›¶å¯„å­˜å™¨)
    ZERO --> NORMAL: ér0
    NORMAL --> SPECIAL: SP/FP/LR
    SPECIAL --> NORMAL: éç‰¹æ®Šå¯„å­˜å™¨

    note right of NORMAL
        æœªä¿®æ”¹çš„æ™®é€šå¯„å­˜å™¨
        é¢œè‰²: #DCDCDC (æµ…ç°)
    end note

    note right of MODIFIED
        æœ€è¿‘ä¿®æ”¹çš„å¯„å­˜å™¨
        é¢œè‰²: #FFB6C1 (æµ…çº¢)
    end note

    note right of ZERO
        é›¶å¯„å­˜å™¨ (ä»…r0)
        é¢œè‰²: #90EE90 (æµ…ç»¿)
        æ’ä¸º0
    end note

    note right of SPECIAL
        ç‰¹æ®Šå¯„å­˜å™¨
        é¢œè‰²: #ADD8E6 (æµ…è“)
        SP(r13), FP(r14), LR(r15)
    end note
```

**é¢œè‰²ç¼–ç **:

| é¢œè‰² | åå…­è¿›åˆ¶å€¼ | åº”ç”¨æ¡ä»¶ | å¯„å­˜å™¨ |
|------|-----------|---------|--------|
| æµ…ç»¿è‰² | #90EE90 | r0 (é›¶å¯„å­˜å™¨) | r0 |
| æµ…çº¢è‰² | #FFB6C1 | æœ€è¿‘ä¿®æ”¹çš„å¯„å­˜å™¨ | r1-r15 |
| æµ…è“è‰² | #ADD8E6 | ç‰¹æ®Šå¯„å­˜å™¨ (SP, FP, LR) | r13-r15 |
| æµ…ç°è‰² | #DCDCDC | æœªä¿®æ”¹çš„æ™®é€šå¯„å­˜å™¨ | r1-r12 |
| é»„è‰² | #FFFF00 | ç”¨æˆ·é«˜äº® | ä»»æ„ |

**äº‹ä»¶å¤„ç†æµç¨‹**:
1. VMæ‰§è¡ŒæŒ‡ä»¤ â†’ å¯„å­˜å™¨å€¼æ”¹å˜
2. VMRVisualBridge æ¥æ”¶åˆ° RegisterChangeEvent
3. é€šè¿‡ ExecutionCallback ä¼ é€’åˆ° UI çº¿ç¨‹
4. Platform.runLater() è°ƒåº¦åˆ° JavaFX åº”ç”¨çº¿ç¨‹
5. RegisterView.updateRegister() æ›´æ–°æ˜¾ç¤º
6. applyColorCoding() åº”ç”¨é¢œè‰²ç¼–ç 
7. UI é‡æ–°æ¸²æŸ“

---

### 4. CodeView çŠ¶æ€æœº

**èŒè´£**: æ˜¾ç¤ºåæ±‡ç¼–æŒ‡ä»¤ï¼Œé«˜äº®å½“å‰PCä½ç½®ï¼Œæ”¯æŒæ–­ç‚¹

```mermaid
stateDiagram-v2
    [*] --> EMPTY: åˆå§‹åŒ–
    EMPTY --> LOADED: setInstructions()
    LOADED --> ACTIVE: PCå˜åŒ–
    ACTIVE --> HIGHLIGHTING: highlightPC()
    HIGHLIGHTING --> ACTIVE: å®Œæˆé«˜äº®
    ACTIVE --> BREAKPOINT_SET: toggleBreakpoint()
    BREAKPOINT_SET --> ACTIVE: æ–­ç‚¹æ ‡è®°æ˜¾ç¤º

    note right of EMPTY
        ä»£ç é¢æ¿ä¸ºç©º
    end note

    note right of LOADED
        ä»£ç å·²åŠ è½½æ˜¾ç¤º
    end note

    note right of ACTIVE
        ä»£ç é¢æ¿æ´»è·ƒ
    end note

    note right of HIGHLIGHTING
        é«˜äº®å½“å‰PCä½ç½®
        é»„è‰²èƒŒæ™¯
    end note

    note right of BREAKPOINT_SET
        æ–­ç‚¹å·²è®¾ç½®
        çº¢è‰²åœ†ç‚¹æ ‡è®°
    end note
```

**ä»£ç è¡ŒçŠ¶æ€**:

| çŠ¶æ€ | æè¿° | æ˜¾ç¤ºæ ·å¼ |
|------|------|---------|
| NORMAL | æ™®é€šæŒ‡ä»¤è¡Œ | é»˜è®¤æ ·å¼ |
| CURRENT_PC | å½“å‰æ‰§è¡Œä½ç½® | é»„è‰²èƒŒæ™¯ |
| BREAKPOINT | æ–­ç‚¹ä½ç½® | çº¢è‰²åœ†ç‚¹ |
| EXECUTED | å·²æ‰§è¡Œè¿‡çš„æŒ‡ä»¤ | æµ…ç»¿èƒŒæ™¯ |

**äº‹ä»¶å¤„ç†**:

| äº‹ä»¶ | è§¦å‘æ¡ä»¶ | UIæ›´æ–° |
|------|---------|--------|
| setInstructions() | ä»£ç åŠ è½½æˆåŠŸ | æ˜¾ç¤ºæ‰€æœ‰æŒ‡ä»¤ |
| highlightPC() | PCå˜åŒ– | é«˜äº®å½“å‰è¡Œï¼Œæ›´æ–°çŠ¶æ€æ  |
| toggleBreakpoint() | ç”¨æˆ·ç‚¹å‡»ä»£ç è¡Œ | æ·»åŠ /åˆ é™¤æ–­ç‚¹æ ‡è®° |
| refresh() | æ‰§è¡Œå›è°ƒ | åˆ·æ–°æ‰€æœ‰æ˜¾ç¤º |

**æŒ‡ä»¤æ˜¾ç¤ºæ ¼å¼**:
- æ ¼å¼: `"0x{PC:04X}  {åŠ©è®°ç¬¦}  {æ“ä½œæ•°}"`
- ç¤ºä¾‹: `"0x0010  li      r1, 100"`

**äº¤äº’æ“ä½œ**:
- å•å‡»: è®¾ç½®/æ¸…é™¤æ–­ç‚¹
- å³é”®: ä¸Šä¸‹æ–‡èœå• (è·³è½¬ã€æŸ¥çœ‹è¯¦æƒ…)
- åŒå‡»: è·³è½¬åˆ°PC

---

### 5. StatusView çŠ¶æ€æœº

**èŒè´£**: æ˜¾ç¤ºæ‰§è¡Œç»Ÿè®¡ã€VMçŠ¶æ€ã€PCã€æŒ‡ä»¤ä¿¡æ¯

```mermaid
stateDiagram-v2
    [*] --> IDLE: åˆå§‹åŒ–
    IDLE --> READY: UIå°±ç»ª
    READY --> TIMING: æ‰§è¡Œå¼€å§‹
    TIMING --> STOPPED: æ‰§è¡Œæš‚åœ/åœæ­¢
    STOPPED --> TIMING: é‡æ–°å¼€å§‹

    note right of IDLE
        çŠ¶æ€é¢æ¿åˆå§‹åŒ–
    end note

    note right of READY
        å‡†å¤‡æ‰§è¡Œ
        stateLabel: "çŠ¶æ€: å°±ç»ª"
    end note

    note right of TIMING
        æ­£åœ¨è®¡æ—¶
        AnimationTimerè¿è¡Œä¸­
        æ›´æ–°: æ—¶é—´æ˜¾ç¤º
    end note

    note right of STOPPED
        æ‰§è¡Œå·²åœæ­¢
        AnimationTimerå·²åœæ­¢
    end note
```

**çŠ¶æ€å±æ€§**:

| å±æ€§ | æ˜¾ç¤ºæ ¼å¼ | æ›´æ–°æ—¶æœº |
|------|---------|--------|
| çŠ¶æ€ | "çŠ¶æ€: {ä¸­æ–‡åç§°}" | vmStateChanged() |
| PC | "PC: 0x{PC:04X}" | pcChanged() |
| æŒ‡ä»¤æ•° | "æŒ‡ä»¤: {æ­¥æ•°}" | incrementExecutionSteps() |
| æ—¶é—´ | "æ—¶é—´: {ç§’æ•°}.3fs" | AnimationTimer (æ¯å¸§) |
| å½“å‰æŒ‡ä»¤ | "å½“å‰: {åŠ©è®°ç¬¦} {æ“ä½œæ•°}" | afterInstructionExecute() |

**è®¡æ—¶å™¨çŠ¶æ€**:

```mermaid
stateDiagram-v2
    [*] --> NOT_STARTED: åˆå§‹åŒ–
    NOT_STARTED --> RUNNING: startTimer()
    RUNNING --> STOPPED: stopTimer()
    STOPPED --> RUNNING: é‡æ–°å¯åŠ¨

    note right of NOT_STARTED
        è®¡æ—¶å™¨æœªå¯åŠ¨
        startTime = 0
    end note

    note right of RUNNING
        è®¡æ—¶å™¨è¿è¡Œä¸­
        è§¦å‘é¢‘ç‡: ~60 FPS (æ¯16ms)
        æ›´æ–°å†…å®¹: ç»è¿‡æ—¶é—´
    end note

    note right of STOPPED
        è®¡æ—¶å™¨å·²åœæ­¢
        åœæ­¢æ˜¾ç¤ºæ—¶é—´æ›´æ–°
    end note
```

**UIå¸ƒå±€**:

```
[çŠ¶æ€: è¿è¡Œä¸­]  [PC: 0x0010]  [æŒ‡ä»¤: 153]  [æ—¶é—´: 2.456s]  [å½“å‰: add r2, r1, r0]
    â†‘               â†‘              â†‘              â†‘                â†‘
stateLabel      pcLabel       stepsLabel     timeLabel      instructionLabel
```

---

### 6. VMRStepController çŠ¶æ€æœº

**èŒè´£**: ç®¡ç†å•æ­¥æ‰§è¡Œæ¨¡å¼å’Œæ–­ç‚¹æ§åˆ¶

```mermaid
stateDiagram-v2
    [*] --> CONTINUE: åˆå§‹åŒ–
    CONTINUE --> STEP_INTO: stepInto()
    STEP_INTO --> STEP_OVER: stepOver()
    STEP_OVER --> STEP_OUT: stepOut()
    STEP_OUT --> CONTINUE: continueExecution()

    CONTINUE --> RUN_TO_LINE: runToPC(pc)
    RUN_TO_LINE --> PAUSED: åˆ°è¾¾ç›®æ ‡PC

    note right of CONTINUE
        è¿ç»­æ‰§è¡Œæ¨¡å¼
    end note

    note right of STEP_INTO
        å•æ­¥å…¥
        æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤
        åœæ­¢æ¡ä»¶: æ¯æ¡æŒ‡ä»¤å
    end note

    note right of STEP_OVER
        å•æ­¥æ­¥è¿‡
        æ‰§è¡Œå‡½æ•°ä½†ä¸è¿›å…¥
        åœæ­¢æ¡ä»¶: å½“å‰æ ˆæ·±åº¦ä¸å˜
    end note

    note right of STEP_OUT
        å•æ­¥æ­¥å‡º
        æ‰§è¡Œåˆ°å‡½æ•°è¿”å›
        åœæ­¢æ¡ä»¶: æ ˆæ·±åº¦å‡å°‘
    end note

    note right of RUN_TO_LINE
        è¿è¡Œåˆ°æŒ‡å®šPC
        åœæ­¢æ¡ä»¶: åˆ°è¾¾ç›®æ ‡PC
    end note
```

**æ­¥æ‰§è¡Œæ¨¡å¼å¯¹æ¯”**:

| æ¨¡å¼ | è¡Œä¸º | åœæ­¢æ¡ä»¶ |
|------|------|---------|
| STEP_INTO | æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ | æ¯æ¡æŒ‡ä»¤ååœæ­¢ |
| STEP_OVER | æ‰§è¡Œå‡½æ•°ä½†ä¸è¿›å…¥ | å½“å‰æ ˆæ·±åº¦ä¸å˜æ—¶åœæ­¢ |
| STEP_OUT | æ‰§è¡Œåˆ°å‡½æ•°è¿”å› | æ ˆæ·±åº¦å‡å°‘æ—¶åœæ­¢ |
| RUN_TO_LINE | æ‰§è¡Œåˆ°æŒ‡å®šPC | åˆ°è¾¾ç›®æ ‡PCæ—¶åœæ­¢ |
| CONTINUE | è¿ç»­æ‰§è¡Œ | é‡åˆ°æ–­ç‚¹æˆ–ç¨‹åºç»“æŸ |

**æ–­ç‚¹äº¤äº’**:

| æ“ä½œ | åŠ¨ä½œ | VMæ¥å£ |
|------|------|--------|
| setBreakpoint() | æ·»åŠ æ–­ç‚¹åˆ°ç®¡ç†å™¨ | vm.addBreakpoint() |
| clearBreakpoint() | ä»ç®¡ç†å™¨åˆ é™¤æ–­ç‚¹ | vm.removeBreakpoint() |
| toggleBreakpoint() | åˆ‡æ¢æ–­ç‚¹çŠ¶æ€ | vm.hasBreakpoint() + add/remove |
| clearAllBreaks() | æ¸…é™¤æ‰€æœ‰æ–­ç‚¹ | éå†åˆ é™¤ |

**æ¡ä»¶æ–­ç‚¹æ£€æŸ¥æµç¨‹**:

```mermaid
stateDiagram-v2
    [*] --> CheckPC: æŒ‡ä»¤æ‰§è¡Œ
    CheckPC --> NoBreak: PCä¸åœ¨æ–­ç‚¹é›†åˆ
    CheckPC --> CheckDisabled: PCåœ¨æ–­ç‚¹é›†åˆ
    CheckDisabled --> NoBreak: æ–­ç‚¹å·²ç¦ç”¨
    CheckDisabled --> CheckCondition: æ–­ç‚¹å·²å¯ç”¨
    CheckCondition --> NoBreak: æ¡ä»¶è¯„ä¼°ä¸ºfalse
    CheckCondition --> ShouldPause: æ¡ä»¶è¯„ä¼°ä¸ºtrue
    CheckCondition --> ShouldPause: æ— æ¡ä»¶æ–­ç‚¹
    ShouldPause --> [*]: è¿”å› true (æš‚åœ)
    NoBreak --> [*]: è¿”å› false (ç»§ç»­)

    note right of ShouldPause
        è§¦å‘æš‚åœæ‰§è¡Œ
        æ›´æ–°UIæ˜¾ç¤ºæ–­ç‚¹ä½ç½®
    end note

    note right of NoBreak
        ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤
    end note
```

**æ¡ä»¶æ–­ç‚¹æ£€æŸ¥ (`shouldPause(pc)`)**:
1. æ£€æŸ¥PCæ˜¯å¦åœ¨æ–­ç‚¹é›†åˆä¸­
2. æ£€æŸ¥æ–­ç‚¹æ˜¯å¦è¢«ç¦ç”¨
3. å¦‚æœæ˜¯æ¡ä»¶æ–­ç‚¹ï¼Œè¯„ä¼°æ¡ä»¶è¡¨è¾¾å¼
4. è¿”å›æ˜¯å¦åº”è¯¥æš‚åœ

---

## ğŸŠ UI äº‹ä»¶æµæ³³é“å›¾

### æ•´ä½“äº‹ä»¶æµäº¤äº’

```mermaid
sequenceDiagram
    autonumber
    participant ç”¨æˆ·æ“ä½œ
    participant VizVMRLauncher
    participant VMRVisualBridge
    participant VMRStateModel
    participant RegisterVMInterpreter as VM
    participant UIç»„ä»¶

    ç”¨æˆ·æ“ä½œ->>VizVMRLauncher: ç‚¹å‡»"å¼€å§‹"æŒ‰é’®
    VizVMRLauncher->>VMRVisualBridge: start()
    VMRVisualBridge->>VM: vmAdapter.run()
    VM->>VM: å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤
    VM-->>VM: æŒ‡ä»¤æ‰§è¡Œå®Œæˆ
    VM->>VMRStateModel: afterInstructionExecute()
    VMRStateModel->>VMRStateModel: syncRegisters()
    VMRStateModel->>VM: getRegister()
    VM-->>VMRStateModel: è¿”å›å¯„å­˜å™¨å€¼
    VMRStateModel->>VMRStateModel: registerChanged()
    VMRStateModel->>VMRVisualBridge: onRegisterChanged()
    VMRVisualBridge->>UIç»„ä»¶: Platform.runLater()
    UIç»„ä»¶->>UIç»„ä»¶: RegisterView.refresh()
    UIç»„ä»¶->>UIç»„ä»¶: æ›´æ–°æ˜¾ç¤º
    UIç»„ä»¶-->>ç”¨æˆ·æ“ä½œ: UIæ˜¾ç¤ºæ›´æ–°å®Œæˆ
```

### å•æ­¥æ‰§è¡Œæµç¨‹

```mermaid
sequenceDiagram
    autonumber
    participant ç”¨æˆ·
    participant VMRStepController
    participant VMRVisualBridge
    participant VM
    participant VMRStateModel
    participant UIç»„ä»¶

    ç”¨æˆ·->>VMRStepController: ç‚¹å‡»"å•æ­¥"
    VMRStepController->>VMRVisualBridge: stepInto()
    VMRVisualBridge->>VMRStateModel: setVMState(STEPPING)
    VMRVisualBridge->>VM: step()
    VM->>VM: æ‰§è¡Œå•æ¡æŒ‡ä»¤
    VM-->>VMRVisualBridge: afterInstructionExecute()
    VMRVisualBridge->>VMRStateModel: syncRegisters()
    VMRStateModel->>VM: getRegister()
    VM-->>VMRStateModel: è¿”å›å¯„å­˜å™¨å€¼
    VMRStateModel->>VMRVisualBridge: registerChanged()
    VMRVisualBridge->>UIç»„ä»¶: onRegisterChanged()
    UIç»„ä»¶->>UIç»„ä»¶: Platform.runLater()
    UIç»„ä»¶->>UIç»„ä»¶: RegisterView.refresh()
    UIç»„ä»¶->>UIç»„ä»¶: UIæ›´æ–°
    UIç»„ä»¶-->>ç”¨æˆ·: å•æ­¥å®Œæˆ
```

### æš‚åœ/æ¢å¤æµç¨‹

```mermaid
sequenceDiagram
    autonumber
    participant ç”¨æˆ·
    participant VMRVisualBridge
    participant VM
    participant VMRStateModel
    participant UIç»„ä»¶

    ç”¨æˆ·->>VMRVisualBridge: ç‚¹å‡»"æš‚åœ"
    VMRVisualBridge->>VM: pause()
    VM->>VM: vmAdapter.pause()
    VM-->>VMRVisualBridge: æš‚åœå®Œæˆ
    VMRVisualBridge->>VMRStateModel: setVMState(PAUSED)
    VMRStateModel->>VMRVisualBridge: vmStateChanged()
    VMRVisualBridge->>UIç»„ä»¶: onStateChanged()
    UIç»„ä»¶->>UIç»„ä»¶: Platform.runLater()
    UIç»„ä»¶->>UIç»„ä»¶: StatusView.updateState()
    UIç»„ä»¶->>UIç»„ä»¶: UIæ›´æ–°
    UIç»„ä»¶-->>ç”¨æˆ·: UIæ˜¾ç¤º"å·²æš‚åœ"

    rect rgb(200, 220, 200)
    Note over ç”¨æˆ·,UIç»„ä»¶: ç”¨æˆ·è¯·æ±‚æ¢å¤æ‰§è¡Œ
    end

    ç”¨æˆ·->>VMRVisualBridge: ç‚¹å‡»"ç»§ç»­"
    VMRVisualBridge->>VMRVisualBridge: paused.set(false)
    VMRVisualBridge->>VM: vm.setPaused(false)
    VMRVisualBridge->>VMRStateModel: setVMState(RUNNING)
    VMRStateModel->>VMRVisualBridge: vmStateChanged()
    VMRVisualBridge->>UIç»„ä»¶: onStateChanged()
    UIç»„ä»¶->>UIç»„ä»¶: Platform.runLater()
    UIç»„ä»¶->>UIç»„ä»¶: StatusView.updateState()
    UIç»„ä»¶->>UIç»„ä»¶: UIæ›´æ–°
    UIç»„ä»¶-->>ç”¨æˆ·: UIæ˜¾ç¤º"è¿è¡Œä¸­"
```

### æ–­ç‚¹è§¦å‘æµç¨‹

```mermaid
sequenceDiagram
    autonumber
    participant ç”¨æˆ·
    participant VMRStepController
    participant VMRBreakpointManager
    participant VM
    participant VMRStateModel
    participant UIç»„ä»¶

    ç”¨æˆ·->>VMRStepController: ç‚¹å‡»ä»£ç è¡Œ
    VMRStepController->>VMRBreakpointManager: toggleBreakpoint(pc)
    VMRBreakpointManager->>VMRBreakpointManager: setBreakpoint(pc)
    VMRBreakpointManager->>VM: vm.addBreakpoint()
    VMRBreakpointManager-->>UIç»„ä»¶: æ–­ç‚¹å·²è®¾ç½®
    UIç»„ä»¶->>UIç»„ä»¶: Platform.runLater()
    UIç»„ä»¶->>UIç»„ä»¶: CodeView.toggleBreakpoint()
    UIç»„ä»¶->>UIç»„ä»¶: æ˜¾ç¤ºæ–­ç‚¹æ ‡è®°
    UIç»„ä»¶-->>ç”¨æˆ·: UIæ˜¾ç¤ºæ–­ç‚¹

    rect rgb(255, 230, 200)
    Note over ç”¨æˆ·,UIç»„ä»¶: ç”¨æˆ·æ‰§è¡Œç¨‹åºåˆ°æ–­ç‚¹
    end

    ç”¨æˆ·->>VMRStepController: ç‚¹å‡»"ç»§ç»­"
    VMRStepController->>VMRVisualBridge: continueExecution()
    VMRVisualBridge->>VM: start()
    VM->>VM: æ‰§è¡ŒæŒ‡ä»¤...
    VM->>VM: åˆ°è¾¾æ–­ç‚¹PC
    VM->>VMRBreakpointManager: shouldPause(pc)
    VMRBreakpointManager-->>VM: è¿”å› true (æš‚åœ)
    VM->>VM: æ‰§è¡Œæš‚åœ
    VM->>VMRStateModel: setVMState(PAUSED)
    VMRStateModel->>VMRVisualBridge: vmStateChanged()
    VMRVisualBridge->>UIç»„ä»¶: onStateChanged()
    UIç»„ä»¶->>UIç»„ä»¶: Platform.runLater()
    UIç»„ä»¶->>UIç»„ä»¶: CodeView.highlightPC()
    UIç»„ä»¶->>UIç»„ä»¶: StatusView.updateState()
    UIç»„ä»¶->>UIç»„ä»¶: LogView.info("åœ¨æ–­ç‚¹æš‚åœ")
    UIç»„ä»¶-->>ç”¨æˆ·: UIåœ¨æ–­ç‚¹å¤„æš‚åœ
```
æ³³é“: ç”¨æˆ·æ“ä½œ | VizVMRLauncher (UIæ¡†æ¶) | VMRVisualBridge (æ¡¥æ¥å™¨) | VMRStateModel (çŠ¶æ€æ¨¡å‹) | RegisterVMInterpreter (VM) | UIç»„ä»¶ (RegisterViewç­‰)

æ—¶é—´æµ:

ç”¨æˆ·æ“ä½œ           VizVMRLauncher          VMRVisualBridge           VMRStateModel              VM               UIç»„ä»¶
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚ ç‚¹å‡»"å¼€å§‹"æŒ‰é’®       â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚ start()                  â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚ vmAdapter.run()            â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚ å¼€å§‹æ‰§è¡ŒæŒ‡ä»¤        â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚ æŒ‡ä»¤æ‰§è¡Œå®Œæˆ        â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚ afterInstructionExecute()    â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚ syncRegisters()            â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚ getRegister()       â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚ registerChanged()          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚ onRegisterChanged()      â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚ Platform.runLater()     â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚ RegisterView      â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚ refresh()         â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚ æ›´æ–°æ˜¾ç¤º         â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚ UIæ˜¾ç¤ºæ›´æ–°å®Œæˆ       â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚                          â”‚                    â”‚                  â”‚
   â”‚                     â”‚                        â”‚                          â”‚                    â”‚                  â”‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### å•æ­¥æ‰§è¡Œæµç¨‹

```
æ³³é“: ç”¨æˆ· | VMRStepController | VMRVisualBridge | VM | VMRStateModel | UIç»„ä»¶

æ—¶é—´æµ:

ç”¨æˆ·         VMRStepController    VMRVisualBridge      VM          VMRStateModel      UIç»„ä»¶
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚ ç‚¹å‡»"å•æ­¥"       â”‚                    â”‚                â”‚                â”‚              â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚ stepInto()          â”‚                â”‚                â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚ setVMState(STEPPING)â”‚              â”‚              â”‚
 â”‚                 â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚ step()          â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚ æ‰§è¡Œå•æ¡æŒ‡ä»¤     â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚ afterInstructionExecute()â”‚              â”‚              â”‚
 â”‚                 â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚ syncRegisters() â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚ getRegister()   â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚ registerChanged()                â”‚              â”‚
 â”‚                 â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚ onRegisterChanged() â”‚                â”‚              â”‚              â”‚
 â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚ Platform.runLater()
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚ RegisterView.refresh()
 â”‚                 â”‚                    â”‚                â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚ UIæ›´æ–°
 â”‚                 â”‚                    â”‚                â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                 â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚ å•æ­¥å®Œæˆ         â”‚                    â”‚                â”‚                â”‚              â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                â”‚                â”‚              â”‚

```

### æš‚åœ/æ¢å¤æµç¨‹

```
æ³³é“: ç”¨æˆ· | VMRVisualBridge | VM | VMRStateModel | UIç»„ä»¶

æ—¶é—´æµ:

ç”¨æˆ·         VMRVisualBridge       VM              VMRStateModel      UIç»„ä»¶
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”‚ ç‚¹å‡»"æš‚åœ"       â”‚                  â”‚                  â”‚              â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                  â”‚              â”‚
 â”‚                 â”‚ pause()           â”‚                  â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚ vmAdapter.pause()   â”‚              â”‚
 â”‚                 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚ setVMState(PAUSED)â”‚                  â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚ vmStateChanged()   â”‚              â”‚
 â”‚                 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚ onStateChanged()  â”‚                  â”‚              â”‚
 â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚              â”‚
 â”‚                 â”‚ Platform.runLater()â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚ StatusView.updateState()
 â”‚                 â”‚                  â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚ UIæ›´æ–°
 â”‚                 â”‚                  â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”‚ UIæ˜¾ç¤º"å·²æš‚åœ"   â”‚                  â”‚                  â”‚              â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”‚ ç‚¹å‡»"ç»§ç»­"       â”‚                  â”‚                  â”‚              â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚                  â”‚              â”‚
 â”‚                 â”‚ resume()          â”‚                  â”‚              â”‚
 â”‚                 â”‚ paused.set(false) â”‚                  â”‚              â”‚
 â”‚                 â”‚ vm.setPaused(false)                  â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”‚                 â”‚ setVMState(RUNNING)â”‚                  â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚ vmStateChanged()   â”‚              â”‚
 â”‚                 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚ onStateChanged()  â”‚                  â”‚              â”‚
 â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚              â”‚
 â”‚                 â”‚ Platform.runLater()â”‚                  â”‚              â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚ StatusView.updateState()
 â”‚                 â”‚                  â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                 â”‚                  â”‚                  â”‚              â”‚ UIæ›´æ–°
 â”‚                 â”‚                  â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                 â”‚                  â”‚                  â”‚              â”‚
 â”‚ UIæ˜¾ç¤º"è¿è¡Œä¸­"   â”‚                  â”‚                  â”‚              â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚                  â”‚              â”‚

```

### æ–­ç‚¹è§¦å‘æµç¨‹

```
æ³³é“: ç”¨æˆ· | VMRStepController | VMRBreakpointManager | VM | VMRStateModel | UIç»„ä»¶

æ—¶é—´æµ:

ç”¨æˆ·         VMRStepController  VMRBreakpointManager   VM           VMRStateModel      UIç»„ä»¶
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚ ç‚¹å‡»ä»£ç è¡Œ       â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚ toggleBreakpoint(pc) â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚ setBreakpoint(pc)â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚ Platform.runLater()
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ CodeView.toggleBreakpoint()
 â”‚                 â”‚                    â”‚                 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ æ˜¾ç¤ºæ–­ç‚¹æ ‡è®°
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚ UIæ˜¾ç¤ºæ–­ç‚¹       â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚ ç‚¹å‡»"ç»§ç»­"       â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚ continueExecution()  â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚ start()           â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚ æ‰§è¡ŒæŒ‡ä»¤...      â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚ åˆ°è¾¾æ–­ç‚¹PC       â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚ shouldPause(pc)
 â”‚                 â”‚                    â”‚                 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                 â”‚                    â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚                    â”‚                 â”‚ è¿”å› true (æš‚åœ)    â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
 â”‚                 â”‚                    â”‚                 â”‚ æ‰§è¡Œæš‚åœ           â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚ setVMState(PAUSED)
 â”‚                 â”‚                    â”‚                 â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ vmStateChanged()
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ Platform.runLater()
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ CodeView.highlightPC()
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ StatusView.updateState()
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚ LogView.info("åœ¨æ–­ç‚¹æš‚åœ")
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 â”‚                 â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚ UIåœ¨æ–­ç‚¹å¤„æš‚åœ   â”‚                    â”‚                 â”‚                  â”‚              â”‚
 â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                 â”‚                  â”‚              â”‚

```

---

## ğŸ“Š äº‹ä»¶æ‰§è¡Œæµç¨‹æ€»ç»“

### äº‹ä»¶ä¼ æ’­è·¯å¾„

```
[RegisterVMInterpreter]
        â”‚
        â”‚ æŒ‡ä»¤æ‰§è¡Œ
        â”‚ å¯„å­˜å™¨å˜åŒ–
        â”‚ å†…å­˜å˜åŒ–
        â–¼
[VMRInstrumentation / RegisterVMVisualAdapter]
        â”‚
        â”‚ åå°„è¯»å–VMçŠ¶æ€
        â”‚ åŒæ­¥åˆ°VMRStateModel
        â–¼
[VMRStateModel]
        â”‚
        â”‚ è§¦å‘çŠ¶æ€äº‹ä»¶
        â”‚ (registerChanged, memoryChanged, pcChanged)
        â–¼
[VMRVisualBridge]
        â”‚
        â”‚ å®ç°VMRStateListeneræ¥å£
        â”‚ æ¥æ”¶çŠ¶æ€äº‹ä»¶
        â–¼
[ExecutionCallback]
        â”‚
        â”‚ Platform.runLater()è°ƒåº¦
        â”‚ (ç¡®ä¿åœ¨JavaFXåº”ç”¨çº¿ç¨‹æ‰§è¡Œ)
        â–¼
[UI Components]
        â”‚
        â”‚ RegisterView.refresh()
        â”‚ MemoryView.refresh()
        â”‚ CodeView.highlightPC()
        â”‚ StatusView.updateState()
        â–¼
[UIæ›´æ–°å’Œæ¸²æŸ“]
```

### çº¿ç¨‹æ¨¡å‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VMæ‰§è¡Œçº¿ç¨‹                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ RegisterVMInterpreter.execute()                         â”‚  â”‚
â”‚ â”‚ - æ‰§è¡ŒæŒ‡ä»¤                                            â”‚  â”‚
â”‚ â”‚ - ä¿®æ”¹å¯„å­˜å™¨                                          â”‚  â”‚
â”‚ â”‚ - è®¿é—®å†…å­˜                                            â”‚  â”‚
â”‚ â”‚ - æ›´æ–°PC                                              â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ çŠ¶æ€å˜åŒ–
                            â”‚ è§¦å‘äº‹ä»¶
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VMRStateModel (ä»»ä½•çº¿ç¨‹å¯è°ƒç”¨)                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ CopyOnWriteArrayList<VMRStateListener>                   â”‚  â”‚
â”‚ â”‚ çº¿ç¨‹å®‰å…¨çš„ç›‘å¬å™¨éå†                                   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ å›è°ƒé€šçŸ¥
                            â”‚ (å¯èƒ½åœ¨VMçº¿ç¨‹)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ExecutionCallback (å›è°ƒå±‚)                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Platform.runLater(Runnable)                             â”‚  â”‚
â”‚ â”‚ è°ƒåº¦åˆ°JavaFXåº”ç”¨çº¿ç¨‹                                  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ UIæ›´æ–°è¯·æ±‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaFXåº”ç”¨çº¿ç¨‹ (EDT)                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ RegisterView.refresh()                                  â”‚  â”‚
â”‚ â”‚ MemoryView.refresh()                                    â”‚  â”‚
â”‚ â”‚ CodeView.highlightPC()                                  â”‚  â”‚
â”‚ â”‚ StatusView.updateState()                                â”‚  â”‚
â”‚ â”‚ - æ›´æ–°UIç»„ä»¶å±æ€§                                       â”‚  â”‚
â”‚ â”‚ - è§¦å‘é‡æ–°æ¸²æŸ“                                         â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

1. **æ‰¹å¤„ç†æ›´æ–°**: VMRStateModel æä¾›æ‰¹é‡æ›´æ–°æ¥å£ (`registersUpdated`, `memoryUpdated`)
2. **çº¿ç¨‹å®‰å…¨ç›‘å¬å™¨**: ä½¿ç”¨ `CopyOnWriteArrayList` é¿å…å¹¶å‘ä¿®æ”¹å¼‚å¸¸
3. **UIçº¿ç¨‹è°ƒåº¦**: `Platform.runLater()` å°†æ‰€æœ‰UIæ›´æ–°è°ƒåº¦åˆ°JavaFXåº”ç”¨çº¿ç¨‹
4. **å¢é‡æ›´æ–°**: UIç»„ä»¶åªåœ¨å€¼å˜åŒ–æ—¶æ›´æ–°å¯¹åº”çš„å•å…ƒæ ¼
5. **é¢œè‰²ç¼“å­˜**: RegisterView è®°å½• `previousValues[]`ï¼Œåªåœ¨å€¼æ”¹å˜æ—¶è§¦å‘é‡æ–°ç€è‰²

---

## ğŸ”Œ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°UIç»„ä»¶

1. ç»§æ‰¿ `JFXPanelBase` åŸºç±»
2. å®ç° `refresh()` æ–¹æ³•æ›´æ–°æ˜¾ç¤º
3. åœ¨ `VizVMRLauncher.setupExecutionCallback()` ä¸­æ·»åŠ äº‹ä»¶å¤„ç†
4. åœ¨ `createScene()` ä¸­æ·»åŠ åˆ°UIå¸ƒå±€

### æ·»åŠ æ–°äº‹ä»¶ç±»å‹

1. åœ¨ `VMRStateListener` æˆ– `VMRExecutionListener` æ·»åŠ æ¥å£æ–¹æ³•
2. åˆ›å»ºå¯¹åº”çš„äº‹ä»¶ç±» (ç»§æ‰¿ `VMRStateEvent`)
3. åœ¨ `VMRStateModel` ä¸­è§¦å‘äº‹ä»¶
4. åœ¨ `VMRVisualBridge` ä¸­æ¥æ”¶å¹¶è½¬å‘åˆ° `ExecutionCallback`

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.2
**åˆ›å»ºæ—¥æœŸ**: 2026-01-14
**æœ€åæ›´æ–°**: 2026-01-17
**ç»´æŠ¤è€…**: EP18Rå¼€å‘å›¢é˜Ÿ

### æ›´æ–°è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| 1.2 | 2026-01-17 | æ·»åŠ äº‹ä»¶æ‰§è¡Œæµç¨‹åˆ†æç« èŠ‚ï¼›åŒ…å«çŠ¶æ€æœºå›¾ã€æ³³é“å›¾ã€äº‹ä»¶ä¼ æ’­è·¯å¾„ |
| 1.1 | 2026-01-16 | æ·»åŠ  `vmStateChanged()` åˆ° VMRStateListenerï¼›æ›´æ–° VMRStateModel çš„ heap/globals ä¸ºé finalï¼›æ›´æ–°åŒ…ç»“æ„ä»¥åŒ¹é…å®é™…å®ç° |
| 1.0 | 2026-01-14 | åˆå§‹ç‰ˆæœ¬ |
